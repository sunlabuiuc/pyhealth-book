2024-01-24 15:41:30 RETAIN(
  (embeddings): ModuleDict(
    (conditions): Embedding(1672, 256, padding_idx=0)
    (procedures): Embedding(463, 256, padding_idx=0)
    (drugs): Embedding(1413, 256, padding_idx=0)
  )
  (linear_layers): ModuleDict()
  (retain): ModuleDict(
    (conditions): RETAINLayer(
      (dropout_layer): Dropout(p=0.8, inplace=False)
      (alpha_gru): GRU(256, 256, batch_first=True)
      (beta_gru): GRU(256, 256, batch_first=True)
      (alpha_li): Linear(in_features=256, out_features=1, bias=True)
      (beta_li): Linear(in_features=256, out_features=256, bias=True)
    )
    (procedures): RETAINLayer(
      (dropout_layer): Dropout(p=0.8, inplace=False)
      (alpha_gru): GRU(256, 256, batch_first=True)
      (beta_gru): GRU(256, 256, batch_first=True)
      (alpha_li): Linear(in_features=256, out_features=1, bias=True)
      (beta_li): Linear(in_features=256, out_features=256, bias=True)
    )
    (drugs): RETAINLayer(
      (dropout_layer): Dropout(p=0.8, inplace=False)
      (alpha_gru): GRU(256, 256, batch_first=True)
      (beta_gru): GRU(256, 256, batch_first=True)
      (alpha_li): Linear(in_features=256, out_features=1, bias=True)
      (beta_li): Linear(in_features=256, out_features=256, bias=True)
    )
  )
  (fc): Linear(in_features=768, out_features=10, bias=True)
)
2024-01-24 15:41:30 Metrics: ['accuracy', 'cohen_kappa']
2024-01-24 15:41:30 Device: cuda
2024-01-24 15:41:30 
2024-01-24 15:41:30 Training:
2024-01-24 15:41:30 Batch size: 32
2024-01-24 15:41:30 Optimizer: <class 'torch.optim.adam.Adam'>
2024-01-24 15:41:30 Optimizer params: {'lr': 0.001}
2024-01-24 15:41:30 Weight decay: 0.0
2024-01-24 15:41:30 Max grad norm: None
2024-01-24 15:41:30 Val dataloader: <torch.utils.data.dataloader.DataLoader object at 0x7fdd4f4576d0>
2024-01-24 15:41:30 Monitor: cohen_kappa
2024-01-24 15:41:30 Monitor criterion: max
2024-01-24 15:41:30 Epochs: 5
2024-01-24 15:41:30 
2024-01-24 15:42:39 --- Train epoch-0, step-3114 ---
2024-01-24 15:42:39 loss: 2.1174
2024-01-24 15:42:43 --- Eval epoch-0, step-3114 ---
2024-01-24 15:42:43 accuracy: 0.3036
2024-01-24 15:42:43 cohen_kappa: 0.0463
2024-01-24 15:42:43 loss: 1.8107
2024-01-24 15:42:43 New best cohen_kappa score (0.0463) at epoch-0, step-3114
2024-01-24 15:42:43 
2024-01-24 15:43:57 --- Train epoch-1, step-6228 ---
2024-01-24 15:43:57 loss: 2.0174
2024-01-24 15:44:00 --- Eval epoch-1, step-6228 ---
2024-01-24 15:44:00 accuracy: 0.3137
2024-01-24 15:44:00 cohen_kappa: 0.0816
2024-01-24 15:44:00 loss: 1.7840
2024-01-24 15:44:00 New best cohen_kappa score (0.0816) at epoch-1, step-6228
2024-01-24 15:44:00 
2024-01-24 15:45:14 --- Train epoch-2, step-9342 ---
2024-01-24 15:45:14 loss: 1.9638
2024-01-24 15:45:18 --- Eval epoch-2, step-9342 ---
2024-01-24 15:45:18 accuracy: 0.3137
2024-01-24 15:45:18 cohen_kappa: 0.0650
2024-01-24 15:45:18 loss: 1.7739
2024-01-24 15:45:18 
2024-01-24 15:46:26 --- Train epoch-3, step-12456 ---
2024-01-24 15:46:26 loss: 1.9179
2024-01-24 15:46:30 --- Eval epoch-3, step-12456 ---
2024-01-24 15:46:30 accuracy: 0.3175
2024-01-24 15:46:30 cohen_kappa: 0.0618
2024-01-24 15:46:30 loss: 1.7576
2024-01-24 15:46:30 
2024-01-24 15:47:38 --- Train epoch-4, step-15570 ---
2024-01-24 15:47:38 loss: 1.8735
2024-01-24 15:47:41 --- Eval epoch-4, step-15570 ---
2024-01-24 15:47:41 accuracy: 0.3317
2024-01-24 15:47:41 cohen_kappa: 0.0874
2024-01-24 15:47:41 loss: 1.7315
2024-01-24 15:47:41 New best cohen_kappa score (0.0874) at epoch-4, step-15570
2024-01-24 15:47:41 Loaded best model
2024-01-24 15:56:46 RETAIN(
  (embeddings): ModuleDict(
    (conditions): Embedding(1672, 256, padding_idx=0)
    (procedures): Embedding(463, 256, padding_idx=0)
    (drugs): Embedding(1413, 256, padding_idx=0)
  )
  (linear_layers): ModuleDict()
  (retain): ModuleDict(
    (conditions): RETAINLayer(
      (dropout_layer): Dropout(p=0.8, inplace=False)
      (alpha_gru): GRU(256, 256, batch_first=True)
      (beta_gru): GRU(256, 256, batch_first=True)
      (alpha_li): Linear(in_features=256, out_features=1, bias=True)
      (beta_li): Linear(in_features=256, out_features=256, bias=True)
    )
    (procedures): RETAINLayer(
      (dropout_layer): Dropout(p=0.8, inplace=False)
      (alpha_gru): GRU(256, 256, batch_first=True)
      (beta_gru): GRU(256, 256, batch_first=True)
      (alpha_li): Linear(in_features=256, out_features=1, bias=True)
      (beta_li): Linear(in_features=256, out_features=256, bias=True)
    )
    (drugs): RETAINLayer(
      (dropout_layer): Dropout(p=0.8, inplace=False)
      (alpha_gru): GRU(256, 256, batch_first=True)
      (beta_gru): GRU(256, 256, batch_first=True)
      (alpha_li): Linear(in_features=256, out_features=1, bias=True)
      (beta_li): Linear(in_features=256, out_features=256, bias=True)
    )
  )
  (fc): Linear(in_features=768, out_features=10, bias=True)
)
2024-01-24 15:56:46 Metrics: ['accuracy', 'cohen_kappa']
2024-01-24 15:56:46 Device: cuda
2024-01-24 15:56:46 
2024-01-24 15:56:46 Training:
2024-01-24 15:56:46 Batch size: 32
2024-01-24 15:56:46 Optimizer: <class 'torch.optim.adam.Adam'>
2024-01-24 15:56:46 Optimizer params: {'lr': 0.001}
2024-01-24 15:56:46 Weight decay: 0.0
2024-01-24 15:56:46 Max grad norm: None
2024-01-24 15:56:46 Val dataloader: <torch.utils.data.dataloader.DataLoader object at 0x7fdd4f4576d0>
2024-01-24 15:56:46 Monitor: cohen_kappa
2024-01-24 15:56:46 Monitor criterion: max
2024-01-24 15:56:46 Epochs: 20
2024-01-24 15:56:46 
2024-01-24 15:57:55 RETAIN(
  (embeddings): ModuleDict(
    (conditions): Embedding(1672, 256, padding_idx=0)
    (procedures): Embedding(463, 256, padding_idx=0)
    (drugs): Embedding(1413, 256, padding_idx=0)
  )
  (linear_layers): ModuleDict()
  (retain): ModuleDict(
    (conditions): RETAINLayer(
      (dropout_layer): Dropout(p=0.8, inplace=False)
      (alpha_gru): GRU(256, 256, batch_first=True)
      (beta_gru): GRU(256, 256, batch_first=True)
      (alpha_li): Linear(in_features=256, out_features=1, bias=True)
      (beta_li): Linear(in_features=256, out_features=256, bias=True)
    )
    (procedures): RETAINLayer(
      (dropout_layer): Dropout(p=0.8, inplace=False)
      (alpha_gru): GRU(256, 256, batch_first=True)
      (beta_gru): GRU(256, 256, batch_first=True)
      (alpha_li): Linear(in_features=256, out_features=1, bias=True)
      (beta_li): Linear(in_features=256, out_features=256, bias=True)
    )
    (drugs): RETAINLayer(
      (dropout_layer): Dropout(p=0.8, inplace=False)
      (alpha_gru): GRU(256, 256, batch_first=True)
      (beta_gru): GRU(256, 256, batch_first=True)
      (alpha_li): Linear(in_features=256, out_features=1, bias=True)
      (beta_li): Linear(in_features=256, out_features=256, bias=True)
    )
  )
  (fc): Linear(in_features=768, out_features=10, bias=True)
)
2024-01-24 15:57:55 Metrics: ['accuracy', 'cohen_kappa']
2024-01-24 15:57:55 Device: cuda
2024-01-24 15:57:55 
2024-01-24 15:57:55 Training:
2024-01-24 15:57:55 Batch size: 32
2024-01-24 15:57:55 Optimizer: <class 'torch.optim.adam.Adam'>
2024-01-24 15:57:55 Optimizer params: {'lr': 0.001}
2024-01-24 15:57:55 Weight decay: 0.0
2024-01-24 15:57:55 Max grad norm: None
2024-01-24 15:57:55 Val dataloader: <torch.utils.data.dataloader.DataLoader object at 0x7fdd4f4576d0>
2024-01-24 15:57:55 Monitor: cohen_kappa
2024-01-24 15:57:55 Monitor criterion: max
2024-01-24 15:57:55 Epochs: 5
2024-01-24 15:57:55 
2024-01-24 15:59:04 --- Train epoch-0, step-3114 ---
2024-01-24 15:59:04 loss: 1.8127
2024-01-24 15:59:07 --- Eval epoch-0, step-3114 ---
2024-01-24 15:59:07 accuracy: 0.3439
2024-01-24 15:59:07 cohen_kappa: 0.1126
2024-01-24 15:59:07 loss: 1.7034
2024-01-24 15:59:07 New best cohen_kappa score (0.1126) at epoch-0, step-3114
2024-01-24 15:59:07 
2024-01-24 16:00:15 --- Train epoch-1, step-6228 ---
2024-01-24 16:00:15 loss: 1.7882
2024-01-24 16:00:18 --- Eval epoch-1, step-6228 ---
2024-01-24 16:00:18 accuracy: 0.3438
2024-01-24 16:00:18 cohen_kappa: 0.1174
2024-01-24 16:00:18 loss: 1.6930
2024-01-24 16:00:18 New best cohen_kappa score (0.1174) at epoch-1, step-6228
2024-01-24 16:00:18 
2024-01-24 16:01:30 --- Train epoch-2, step-9342 ---
2024-01-24 16:01:30 loss: 1.7691
2024-01-24 16:01:33 --- Eval epoch-2, step-9342 ---
2024-01-24 16:01:33 accuracy: 0.3477
2024-01-24 16:01:33 cohen_kappa: 0.1213
2024-01-24 16:01:33 loss: 1.6749
2024-01-24 16:01:33 New best cohen_kappa score (0.1213) at epoch-2, step-9342
2024-01-24 16:01:34 
2024-01-24 16:02:45 --- Train epoch-3, step-12456 ---
2024-01-24 16:02:45 loss: 1.7543
2024-01-24 16:02:48 --- Eval epoch-3, step-12456 ---
2024-01-24 16:02:48 accuracy: 0.3475
2024-01-24 16:02:48 cohen_kappa: 0.1168
2024-01-24 16:02:48 loss: 1.6650
2024-01-24 16:02:48 
2024-01-24 16:03:56 --- Train epoch-4, step-15570 ---
2024-01-24 16:03:56 loss: 1.7406
2024-01-24 16:04:00 --- Eval epoch-4, step-15570 ---
2024-01-24 16:04:00 accuracy: 0.3542
2024-01-24 16:04:00 cohen_kappa: 0.1297
2024-01-24 16:04:00 loss: 1.6550
2024-01-24 16:04:00 New best cohen_kappa score (0.1297) at epoch-4, step-15570
2024-01-24 16:04:00 Loaded best model
2024-01-24 16:08:40 RETAIN(
  (embeddings): ModuleDict(
    (conditions): Embedding(1672, 256, padding_idx=0)
    (procedures): Embedding(463, 256, padding_idx=0)
    (drugs): Embedding(1413, 256, padding_idx=0)
  )
  (linear_layers): ModuleDict()
  (retain): ModuleDict(
    (conditions): RETAINLayer(
      (dropout_layer): Dropout(p=0.8, inplace=False)
      (alpha_gru): GRU(256, 256, batch_first=True)
      (beta_gru): GRU(256, 256, batch_first=True)
      (alpha_li): Linear(in_features=256, out_features=1, bias=True)
      (beta_li): Linear(in_features=256, out_features=256, bias=True)
    )
    (procedures): RETAINLayer(
      (dropout_layer): Dropout(p=0.8, inplace=False)
      (alpha_gru): GRU(256, 256, batch_first=True)
      (beta_gru): GRU(256, 256, batch_first=True)
      (alpha_li): Linear(in_features=256, out_features=1, bias=True)
      (beta_li): Linear(in_features=256, out_features=256, bias=True)
    )
    (drugs): RETAINLayer(
      (dropout_layer): Dropout(p=0.8, inplace=False)
      (alpha_gru): GRU(256, 256, batch_first=True)
      (beta_gru): GRU(256, 256, batch_first=True)
      (alpha_li): Linear(in_features=256, out_features=1, bias=True)
      (beta_li): Linear(in_features=256, out_features=256, bias=True)
    )
  )
  (fc): Linear(in_features=768, out_features=10, bias=True)
)
2024-01-24 16:08:40 Metrics: ['accuracy', 'cohen_kappa']
2024-01-24 16:08:40 Device: cuda
2024-01-24 16:08:40 
2024-01-24 16:08:40 Training:
2024-01-24 16:08:40 Batch size: 32
2024-01-24 16:08:40 Optimizer: <class 'torch.optim.adam.Adam'>
2024-01-24 16:08:40 Optimizer params: {'lr': 0.001}
2024-01-24 16:08:40 Weight decay: 0.0
2024-01-24 16:08:40 Max grad norm: None
2024-01-24 16:08:40 Val dataloader: <torch.utils.data.dataloader.DataLoader object at 0x7fdd4f4576d0>
2024-01-24 16:08:40 Monitor: cohen_kappa
2024-01-24 16:08:40 Monitor criterion: max
2024-01-24 16:08:40 Epochs: 5
2024-01-24 16:08:40 
2024-01-24 16:09:51 --- Train epoch-0, step-3114 ---
2024-01-24 16:09:51 loss: 1.7337
2024-01-24 16:09:55 --- Eval epoch-0, step-3114 ---
2024-01-24 16:09:55 accuracy: 0.3540
2024-01-24 16:09:55 cohen_kappa: 0.1273
2024-01-24 16:09:55 loss: 1.6522
2024-01-24 16:09:55 New best cohen_kappa score (0.1273) at epoch-0, step-3114
2024-01-24 16:09:55 
2024-01-24 16:11:08 --- Train epoch-1, step-6228 ---
2024-01-24 16:11:08 loss: 1.7220
2024-01-24 16:11:12 --- Eval epoch-1, step-6228 ---
2024-01-24 16:11:12 accuracy: 0.3611
2024-01-24 16:11:12 cohen_kappa: 0.1540
2024-01-24 16:11:12 loss: 1.6399
2024-01-24 16:11:12 New best cohen_kappa score (0.1540) at epoch-1, step-6228
2024-01-24 16:11:12 
2024-01-24 16:12:22 --- Train epoch-2, step-9342 ---
2024-01-24 16:12:22 loss: 1.7116
2024-01-24 16:12:25 --- Eval epoch-2, step-9342 ---
2024-01-24 16:12:25 accuracy: 0.3616
2024-01-24 16:12:25 cohen_kappa: 0.1441
2024-01-24 16:12:25 loss: 1.6351
2024-01-24 16:12:25 
2024-01-24 16:12:40 RETAIN(
  (embeddings): ModuleDict(
    (conditions): Embedding(1672, 256, padding_idx=0)
    (procedures): Embedding(463, 256, padding_idx=0)
    (drugs): Embedding(1413, 256, padding_idx=0)
  )
  (linear_layers): ModuleDict()
  (retain): ModuleDict(
    (conditions): RETAINLayer(
      (dropout_layer): Dropout(p=0.8, inplace=False)
      (alpha_gru): GRU(256, 256, batch_first=True)
      (beta_gru): GRU(256, 256, batch_first=True)
      (alpha_li): Linear(in_features=256, out_features=1, bias=True)
      (beta_li): Linear(in_features=256, out_features=256, bias=True)
    )
    (procedures): RETAINLayer(
      (dropout_layer): Dropout(p=0.8, inplace=False)
      (alpha_gru): GRU(256, 256, batch_first=True)
      (beta_gru): GRU(256, 256, batch_first=True)
      (alpha_li): Linear(in_features=256, out_features=1, bias=True)
      (beta_li): Linear(in_features=256, out_features=256, bias=True)
    )
    (drugs): RETAINLayer(
      (dropout_layer): Dropout(p=0.8, inplace=False)
      (alpha_gru): GRU(256, 256, batch_first=True)
      (beta_gru): GRU(256, 256, batch_first=True)
      (alpha_li): Linear(in_features=256, out_features=1, bias=True)
      (beta_li): Linear(in_features=256, out_features=256, bias=True)
    )
  )
  (fc): Linear(in_features=768, out_features=10, bias=True)
)
2024-01-24 16:12:40 Metrics: ['accuracy', 'cohen_kappa']
2024-01-24 16:12:40 Device: cuda
2024-01-24 16:12:40 
2024-01-24 16:12:40 Training:
2024-01-24 16:12:40 Batch size: 256
2024-01-24 16:12:40 Optimizer: <class 'torch.optim.adam.Adam'>
2024-01-24 16:12:40 Optimizer params: {'lr': 0.001}
2024-01-24 16:12:40 Weight decay: 0.0
2024-01-24 16:12:40 Max grad norm: None
2024-01-24 16:12:40 Val dataloader: <torch.utils.data.dataloader.DataLoader object at 0x7fdaf3db9b20>
2024-01-24 16:12:40 Monitor: cohen_kappa
2024-01-24 16:12:40 Monitor criterion: max
2024-01-24 16:12:40 Epochs: 3
2024-01-24 16:12:40 
2024-01-24 16:13:21 --- Train epoch-0, step-390 ---
2024-01-24 16:13:21 loss: 1.6861
2024-01-24 16:13:23 --- Eval epoch-0, step-390 ---
2024-01-24 16:13:23 accuracy: 0.3642
2024-01-24 16:13:23 cohen_kappa: 0.1460
2024-01-24 16:13:23 loss: 1.6052
2024-01-24 16:13:23 New best cohen_kappa score (0.1460) at epoch-0, step-390
2024-01-24 16:13:23 
2024-01-24 16:14:05 --- Train epoch-1, step-780 ---
2024-01-24 16:14:05 loss: 1.6721
2024-01-24 16:14:07 --- Eval epoch-1, step-780 ---
2024-01-24 16:14:07 accuracy: 0.3628
2024-01-24 16:14:07 cohen_kappa: 0.1586
2024-01-24 16:14:07 loss: 1.6047
2024-01-24 16:14:07 New best cohen_kappa score (0.1586) at epoch-1, step-780
2024-01-24 16:14:07 
2024-01-24 16:14:49 --- Train epoch-2, step-1170 ---
2024-01-24 16:14:49 loss: 1.6688
2024-01-24 16:14:51 --- Eval epoch-2, step-1170 ---
2024-01-24 16:14:51 accuracy: 0.3672
2024-01-24 16:14:51 cohen_kappa: 0.1569
2024-01-24 16:14:51 loss: 1.6010
2024-01-24 16:14:51 Loaded best model
