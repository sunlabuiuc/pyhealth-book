2024-01-24 16:12:40 RETAIN(
  (embeddings): ModuleDict(
    (conditions): Embedding(1672, 256, padding_idx=0)
    (procedures): Embedding(463, 256, padding_idx=0)
    (drugs): Embedding(1413, 256, padding_idx=0)
  )
  (linear_layers): ModuleDict()
  (retain): ModuleDict(
    (conditions): RETAINLayer(
      (dropout_layer): Dropout(p=0.8, inplace=False)
      (alpha_gru): GRU(256, 256, batch_first=True)
      (beta_gru): GRU(256, 256, batch_first=True)
      (alpha_li): Linear(in_features=256, out_features=1, bias=True)
      (beta_li): Linear(in_features=256, out_features=256, bias=True)
    )
    (procedures): RETAINLayer(
      (dropout_layer): Dropout(p=0.8, inplace=False)
      (alpha_gru): GRU(256, 256, batch_first=True)
      (beta_gru): GRU(256, 256, batch_first=True)
      (alpha_li): Linear(in_features=256, out_features=1, bias=True)
      (beta_li): Linear(in_features=256, out_features=256, bias=True)
    )
    (drugs): RETAINLayer(
      (dropout_layer): Dropout(p=0.8, inplace=False)
      (alpha_gru): GRU(256, 256, batch_first=True)
      (beta_gru): GRU(256, 256, batch_first=True)
      (alpha_li): Linear(in_features=256, out_features=1, bias=True)
      (beta_li): Linear(in_features=256, out_features=256, bias=True)
    )
  )
  (fc): Linear(in_features=768, out_features=10, bias=True)
)
2024-01-24 16:12:40 Metrics: ['accuracy', 'cohen_kappa']
2024-01-24 16:12:40 Device: cuda
2024-01-24 16:12:40 
2024-01-24 16:12:40 Training:
2024-01-24 16:12:40 Batch size: 256
2024-01-24 16:12:40 Optimizer: <class 'torch.optim.adam.Adam'>
2024-01-24 16:12:40 Optimizer params: {'lr': 0.001}
2024-01-24 16:12:40 Weight decay: 0.0
2024-01-24 16:12:40 Max grad norm: None
2024-01-24 16:12:40 Val dataloader: <torch.utils.data.dataloader.DataLoader object at 0x7fdaf3db9b20>
2024-01-24 16:12:40 Monitor: cohen_kappa
2024-01-24 16:12:40 Monitor criterion: max
2024-01-24 16:12:40 Epochs: 3
2024-01-24 16:12:40 
2024-01-24 16:13:21 --- Train epoch-0, step-390 ---
2024-01-24 16:13:21 loss: 1.6861
2024-01-24 16:13:23 --- Eval epoch-0, step-390 ---
2024-01-24 16:13:23 accuracy: 0.3642
2024-01-24 16:13:23 cohen_kappa: 0.1460
2024-01-24 16:13:23 loss: 1.6052
2024-01-24 16:13:23 New best cohen_kappa score (0.1460) at epoch-0, step-390
2024-01-24 16:13:23 
2024-01-24 16:14:05 --- Train epoch-1, step-780 ---
2024-01-24 16:14:05 loss: 1.6721
2024-01-24 16:14:07 --- Eval epoch-1, step-780 ---
2024-01-24 16:14:07 accuracy: 0.3628
2024-01-24 16:14:07 cohen_kappa: 0.1586
2024-01-24 16:14:07 loss: 1.6047
2024-01-24 16:14:07 New best cohen_kappa score (0.1586) at epoch-1, step-780
2024-01-24 16:14:07 
2024-01-24 16:14:49 --- Train epoch-2, step-1170 ---
2024-01-24 16:14:49 loss: 1.6688
2024-01-24 16:14:51 --- Eval epoch-2, step-1170 ---
2024-01-24 16:14:51 accuracy: 0.3672
2024-01-24 16:14:51 cohen_kappa: 0.1569
2024-01-24 16:14:51 loss: 1.6010
2024-01-24 16:14:51 Loaded best model
