2023-11-07 16:35:42 RNN(
  (embeddings): ModuleDict(
    (diagnoses): Embedding(601, 64, padding_idx=0)
  )
  (linear_layers): ModuleDict()
  (rnn): ModuleDict(
    (diagnoses): RNNLayer(
      (dropout_layer): Dropout(p=0.5, inplace=False)
      (rnn): LSTM(64, 64, num_layers=2, batch_first=True, dropout=0.5)
    )
  )
  (fc): Linear(in_features=64, out_features=1, bias=True)
)
2023-11-07 16:35:42 Metrics: ['pr_auc', 'roc_auc', 'f1']
2023-11-07 16:35:42 Device: cuda
2023-11-07 16:35:42 
2023-11-07 16:35:42 Training:
2023-11-07 16:35:42 Batch size: 64
2023-11-07 16:35:42 Optimizer: <class 'torch.optim.adam.Adam'>
2023-11-07 16:35:42 Optimizer params: {'lr': 0.001}
2023-11-07 16:35:42 Weight decay: 0.0
2023-11-07 16:35:42 Max grad norm: None
2023-11-07 16:35:42 Val dataloader: <torch.utils.data.dataloader.DataLoader object at 0x7fc77a395cd0>
2023-11-07 16:35:42 Monitor: roc_auc
2023-11-07 16:35:42 Monitor criterion: max
2023-11-07 16:35:42 Epochs: 50
2023-11-07 16:35:42 
2023-11-07 16:35:42 --- Train epoch-0, step-13 ---
2023-11-07 16:35:42 loss: 0.4748
2023-11-07 16:35:42 --- Eval epoch-0, step-13 ---
2023-11-07 16:35:42 pr_auc: 0.7821
2023-11-07 16:35:42 roc_auc: 0.7749
2023-11-07 16:35:42 f1: 0.7718
2023-11-07 16:35:42 loss: 0.6469
2023-11-07 16:35:42 New best roc_auc score (0.7749) at epoch-0, step-13
2023-11-07 16:35:42 
2023-11-07 16:35:42 --- Train epoch-1, step-26 ---
2023-11-07 16:35:42 loss: 0.4713
2023-11-07 16:35:42 --- Eval epoch-1, step-26 ---
2023-11-07 16:35:42 pr_auc: 0.7808
2023-11-07 16:35:42 roc_auc: 0.7720
2023-11-07 16:35:42 f1: 0.7718
2023-11-07 16:35:42 loss: 0.6474
2023-11-07 16:35:42 
2023-11-07 16:35:43 --- Train epoch-2, step-39 ---
2023-11-07 16:35:43 loss: 0.4336
2023-11-07 16:35:43 --- Eval epoch-2, step-39 ---
2023-11-07 16:35:43 pr_auc: 0.7801
2023-11-07 16:35:43 roc_auc: 0.7704
2023-11-07 16:35:43 f1: 0.7724
2023-11-07 16:35:43 loss: 0.6554
2023-11-07 16:35:43 
2023-11-07 16:35:43 --- Train epoch-3, step-52 ---
2023-11-07 16:35:43 loss: 0.4522
2023-11-07 16:35:43 --- Eval epoch-3, step-52 ---
2023-11-07 16:35:43 pr_auc: 0.7795
2023-11-07 16:35:43 roc_auc: 0.7726
2023-11-07 16:35:43 f1: 0.7769
2023-11-07 16:35:43 loss: 0.6564
2023-11-07 16:35:43 
2023-11-07 16:35:43 --- Train epoch-4, step-65 ---
2023-11-07 16:35:43 loss: 0.4532
2023-11-07 16:35:44 --- Eval epoch-4, step-65 ---
2023-11-07 16:35:44 pr_auc: 0.7815
2023-11-07 16:35:44 roc_auc: 0.7774
2023-11-07 16:35:44 f1: 0.7851
2023-11-07 16:35:44 loss: 0.6410
2023-11-07 16:35:44 New best roc_auc score (0.7774) at epoch-4, step-65
2023-11-07 16:35:44 
2023-11-07 16:35:44 --- Train epoch-5, step-78 ---
2023-11-07 16:35:44 loss: 0.4667
2023-11-07 16:35:44 --- Eval epoch-5, step-78 ---
2023-11-07 16:35:44 pr_auc: 0.7851
2023-11-07 16:35:44 roc_auc: 0.7822
2023-11-07 16:35:44 f1: 0.7901
2023-11-07 16:35:44 loss: 0.6254
2023-11-07 16:35:44 New best roc_auc score (0.7822) at epoch-5, step-78
2023-11-07 16:35:44 
2023-11-07 16:35:44 --- Train epoch-6, step-91 ---
2023-11-07 16:35:44 loss: 0.4198
2023-11-07 16:35:44 --- Eval epoch-6, step-91 ---
2023-11-07 16:35:44 pr_auc: 0.7886
2023-11-07 16:35:44 roc_auc: 0.7865
2023-11-07 16:35:44 f1: 0.7950
2023-11-07 16:35:44 loss: 0.6179
2023-11-07 16:35:44 New best roc_auc score (0.7865) at epoch-6, step-91
2023-11-07 16:35:44 
2023-11-07 16:35:45 --- Train epoch-7, step-104 ---
2023-11-07 16:35:45 loss: 0.4342
2023-11-07 16:35:45 --- Eval epoch-7, step-104 ---
2023-11-07 16:35:45 pr_auc: 0.7825
2023-11-07 16:35:45 roc_auc: 0.7799
2023-11-07 16:35:45 f1: 0.7934
2023-11-07 16:35:45 loss: 0.6542
2023-11-07 16:35:45 
2023-11-07 16:35:45 --- Train epoch-8, step-117 ---
2023-11-07 16:35:45 loss: 0.4335
2023-11-07 16:35:45 --- Eval epoch-8, step-117 ---
2023-11-07 16:35:45 pr_auc: 0.7775
2023-11-07 16:35:45 roc_auc: 0.7776
2023-11-07 16:35:45 f1: 0.7901
2023-11-07 16:35:45 loss: 0.6655
2023-11-07 16:35:45 
2023-11-07 16:35:45 --- Train epoch-9, step-130 ---
2023-11-07 16:35:45 loss: 0.4339
2023-11-07 16:35:45 --- Eval epoch-9, step-130 ---
2023-11-07 16:35:45 pr_auc: 0.7863
2023-11-07 16:35:45 roc_auc: 0.7843
2023-11-07 16:35:45 f1: 0.7745
2023-11-07 16:35:45 loss: 0.6427
2023-11-07 16:35:45 
2023-11-07 16:35:45 --- Train epoch-10, step-143 ---
2023-11-07 16:35:45 loss: 0.4301
2023-11-07 16:35:45 --- Eval epoch-10, step-143 ---
2023-11-07 16:35:45 pr_auc: 0.7814
2023-11-07 16:35:45 roc_auc: 0.7813
2023-11-07 16:35:45 f1: 0.7935
2023-11-07 16:35:45 loss: 0.6626
2023-11-07 16:35:45 
2023-11-07 16:35:45 --- Train epoch-11, step-156 ---
2023-11-07 16:35:45 loss: 0.3909
2023-11-07 16:35:46 --- Eval epoch-11, step-156 ---
2023-11-07 16:35:46 pr_auc: 0.7822
2023-11-07 16:35:46 roc_auc: 0.7822
2023-11-07 16:35:46 f1: 0.7837
2023-11-07 16:35:46 loss: 0.6565
2023-11-07 16:35:46 
2023-11-07 16:35:46 --- Train epoch-12, step-169 ---
2023-11-07 16:35:46 loss: 0.4196
2023-11-07 16:35:46 --- Eval epoch-12, step-169 ---
2023-11-07 16:35:46 pr_auc: 0.7795
2023-11-07 16:35:46 roc_auc: 0.7803
2023-11-07 16:35:46 f1: 0.7801
2023-11-07 16:35:46 loss: 0.6701
2023-11-07 16:35:46 
2023-11-07 16:35:46 --- Train epoch-13, step-182 ---
2023-11-07 16:35:46 loss: 0.4146
2023-11-07 16:35:46 --- Eval epoch-13, step-182 ---
2023-11-07 16:35:46 pr_auc: 0.7734
2023-11-07 16:35:46 roc_auc: 0.7738
2023-11-07 16:35:46 f1: 0.7769
2023-11-07 16:35:46 loss: 0.6769
2023-11-07 16:35:46 
2023-11-07 16:35:47 --- Train epoch-14, step-195 ---
2023-11-07 16:35:47 loss: 0.4334
2023-11-07 16:35:47 --- Eval epoch-14, step-195 ---
2023-11-07 16:35:47 pr_auc: 0.7721
2023-11-07 16:35:47 roc_auc: 0.7729
2023-11-07 16:35:47 f1: 0.7869
2023-11-07 16:35:47 loss: 0.6898
2023-11-07 16:35:47 
2023-11-07 16:35:47 --- Train epoch-15, step-208 ---
2023-11-07 16:35:47 loss: 0.4364
2023-11-07 16:35:47 --- Eval epoch-15, step-208 ---
2023-11-07 16:35:47 pr_auc: 0.7712
2023-11-07 16:35:47 roc_auc: 0.7770
2023-11-07 16:35:47 f1: 0.7833
2023-11-07 16:35:47 loss: 0.6557
2023-11-07 16:35:47 
2023-11-07 16:35:47 --- Train epoch-16, step-221 ---
2023-11-07 16:35:47 loss: 0.3966
2023-11-07 16:35:47 --- Eval epoch-16, step-221 ---
2023-11-07 16:35:47 pr_auc: 0.7781
2023-11-07 16:35:47 roc_auc: 0.7817
2023-11-07 16:35:47 f1: 0.7866
2023-11-07 16:35:47 loss: 0.6403
2023-11-07 16:35:47 
2023-11-07 16:35:48 --- Train epoch-17, step-234 ---
2023-11-07 16:35:48 loss: 0.4133
2023-11-07 16:35:48 --- Eval epoch-17, step-234 ---
2023-11-07 16:35:48 pr_auc: 0.7756
2023-11-07 16:35:48 roc_auc: 0.7817
2023-11-07 16:35:48 f1: 0.7866
2023-11-07 16:35:48 loss: 0.6563
2023-11-07 16:35:48 
2023-11-07 16:35:48 --- Train epoch-18, step-247 ---
2023-11-07 16:35:48 loss: 0.3811
2023-11-07 16:35:48 --- Eval epoch-18, step-247 ---
2023-11-07 16:35:48 pr_auc: 0.7777
2023-11-07 16:35:48 roc_auc: 0.7840
2023-11-07 16:35:48 f1: 0.7815
2023-11-07 16:35:48 loss: 0.6707
2023-11-07 16:35:48 
2023-11-07 16:35:48 --- Train epoch-19, step-260 ---
2023-11-07 16:35:48 loss: 0.4056
2023-11-07 16:35:49 --- Eval epoch-19, step-260 ---
2023-11-07 16:35:49 pr_auc: 0.7817
2023-11-07 16:35:49 roc_auc: 0.7877
2023-11-07 16:35:49 f1: 0.7815
2023-11-07 16:35:49 loss: 0.6751
2023-11-07 16:35:49 New best roc_auc score (0.7877) at epoch-19, step-260
2023-11-07 16:35:49 
2023-11-07 16:35:49 --- Train epoch-20, step-273 ---
2023-11-07 16:35:49 loss: 0.4057
2023-11-07 16:35:49 --- Eval epoch-20, step-273 ---
2023-11-07 16:35:49 pr_auc: 0.7837
2023-11-07 16:35:49 roc_auc: 0.7895
2023-11-07 16:35:49 f1: 0.7833
2023-11-07 16:35:49 loss: 0.6652
2023-11-07 16:35:49 New best roc_auc score (0.7895) at epoch-20, step-273
2023-11-07 16:35:49 
2023-11-07 16:35:49 --- Train epoch-21, step-286 ---
2023-11-07 16:35:49 loss: 0.3793
2023-11-07 16:35:49 --- Eval epoch-21, step-286 ---
2023-11-07 16:35:49 pr_auc: 0.7848
2023-11-07 16:35:49 roc_auc: 0.7904
2023-11-07 16:35:49 f1: 0.7731
2023-11-07 16:35:49 loss: 0.6705
2023-11-07 16:35:49 New best roc_auc score (0.7904) at epoch-21, step-286
2023-11-07 16:35:49 
2023-11-07 16:35:50 --- Train epoch-22, step-299 ---
2023-11-07 16:35:50 loss: 0.3823
2023-11-07 16:35:50 --- Eval epoch-22, step-299 ---
2023-11-07 16:35:50 pr_auc: 0.7817
2023-11-07 16:35:50 roc_auc: 0.7866
2023-11-07 16:35:50 f1: 0.7764
2023-11-07 16:35:50 loss: 0.6864
2023-11-07 16:35:50 
2023-11-07 16:35:50 --- Train epoch-23, step-312 ---
2023-11-07 16:35:50 loss: 0.3766
2023-11-07 16:35:50 --- Eval epoch-23, step-312 ---
2023-11-07 16:35:50 pr_auc: 0.7829
2023-11-07 16:35:50 roc_auc: 0.7854
2023-11-07 16:35:50 f1: 0.7731
2023-11-07 16:35:50 loss: 0.6938
2023-11-07 16:35:50 
2023-11-07 16:35:50 --- Train epoch-24, step-325 ---
2023-11-07 16:35:50 loss: 0.3826
2023-11-07 16:35:50 --- Eval epoch-24, step-325 ---
2023-11-07 16:35:50 pr_auc: 0.7813
2023-11-07 16:35:50 roc_auc: 0.7852
2023-11-07 16:35:50 f1: 0.7679
2023-11-07 16:35:50 loss: 0.6923
2023-11-07 16:35:50 
2023-11-07 16:35:51 --- Train epoch-25, step-338 ---
2023-11-07 16:35:51 loss: 0.3735
2023-11-07 16:35:51 --- Eval epoch-25, step-338 ---
2023-11-07 16:35:51 pr_auc: 0.7744
2023-11-07 16:35:51 roc_auc: 0.7807
2023-11-07 16:35:51 f1: 0.7615
2023-11-07 16:35:51 loss: 0.7012
2023-11-07 16:35:51 
2023-11-07 16:35:51 --- Train epoch-26, step-351 ---
2023-11-07 16:35:51 loss: 0.3620
2023-11-07 16:35:51 --- Eval epoch-26, step-351 ---
2023-11-07 16:35:51 pr_auc: 0.7758
2023-11-07 16:35:51 roc_auc: 0.7840
2023-11-07 16:35:51 f1: 0.7639
2023-11-07 16:35:51 loss: 0.6967
2023-11-07 16:35:51 
2023-11-07 16:35:52 --- Train epoch-27, step-364 ---
2023-11-07 16:35:52 loss: 0.3897
2023-11-07 16:35:52 --- Eval epoch-27, step-364 ---
2023-11-07 16:35:52 pr_auc: 0.7736
2023-11-07 16:35:52 roc_auc: 0.7817
2023-11-07 16:35:52 f1: 0.7595
2023-11-07 16:35:52 loss: 0.6994
2023-11-07 16:35:52 
2023-11-07 16:35:52 --- Train epoch-28, step-377 ---
2023-11-07 16:35:52 loss: 0.4081
2023-11-07 16:35:52 --- Eval epoch-28, step-377 ---
2023-11-07 16:35:52 pr_auc: 0.7754
2023-11-07 16:35:52 roc_auc: 0.7826
2023-11-07 16:35:52 f1: 0.7712
2023-11-07 16:35:52 loss: 0.6765
2023-11-07 16:35:52 
2023-11-07 16:35:52 --- Train epoch-29, step-390 ---
2023-11-07 16:35:52 loss: 0.3772
2023-11-07 16:35:52 --- Eval epoch-29, step-390 ---
2023-11-07 16:35:52 pr_auc: 0.7684
2023-11-07 16:35:52 roc_auc: 0.7787
2023-11-07 16:35:52 f1: 0.7819
2023-11-07 16:35:52 loss: 0.6903
2023-11-07 16:35:52 
2023-11-07 16:35:53 --- Train epoch-30, step-403 ---
2023-11-07 16:35:53 loss: 0.3816
2023-11-07 16:35:53 --- Eval epoch-30, step-403 ---
2023-11-07 16:35:53 pr_auc: 0.7765
2023-11-07 16:35:53 roc_auc: 0.7843
2023-11-07 16:35:53 f1: 0.7586
2023-11-07 16:35:53 loss: 0.6770
2023-11-07 16:35:53 
2023-11-07 16:35:53 --- Train epoch-31, step-416 ---
2023-11-07 16:35:53 loss: 0.3565
2023-11-07 16:35:53 --- Eval epoch-31, step-416 ---
2023-11-07 16:35:53 pr_auc: 0.7702
2023-11-07 16:35:53 roc_auc: 0.7804
2023-11-07 16:35:53 f1: 0.7679
2023-11-07 16:35:53 loss: 0.7104
2023-11-07 16:35:53 
2023-11-07 16:35:53 --- Train epoch-32, step-429 ---
2023-11-07 16:35:53 loss: 0.3517
2023-11-07 16:35:53 --- Eval epoch-32, step-429 ---
2023-11-07 16:35:53 pr_auc: 0.7752
2023-11-07 16:35:53 roc_auc: 0.7847
2023-11-07 16:35:53 f1: 0.7627
2023-11-07 16:35:53 loss: 0.7254
2023-11-07 16:35:53 
2023-11-07 16:35:54 --- Train epoch-33, step-442 ---
2023-11-07 16:35:54 loss: 0.3562
2023-11-07 16:35:54 --- Eval epoch-33, step-442 ---
2023-11-07 16:35:54 pr_auc: 0.7732
2023-11-07 16:35:54 roc_auc: 0.7832
2023-11-07 16:35:54 f1: 0.7699
2023-11-07 16:35:54 loss: 0.7426
2023-11-07 16:35:54 
2023-11-07 16:35:54 --- Train epoch-34, step-455 ---
2023-11-07 16:35:54 loss: 0.3311
2023-11-07 16:35:54 --- Eval epoch-34, step-455 ---
2023-11-07 16:35:54 pr_auc: 0.7805
2023-11-07 16:35:54 roc_auc: 0.7870
2023-11-07 16:35:54 f1: 0.7607
2023-11-07 16:35:54 loss: 0.7253
2023-11-07 16:35:54 
2023-11-07 16:35:54 --- Train epoch-35, step-468 ---
2023-11-07 16:35:54 loss: 0.3457
2023-11-07 16:35:54 --- Eval epoch-35, step-468 ---
2023-11-07 16:35:54 pr_auc: 0.7817
2023-11-07 16:35:54 roc_auc: 0.7869
2023-11-07 16:35:54 f1: 0.7712
2023-11-07 16:35:54 loss: 0.7309
2023-11-07 16:35:54 
2023-11-07 16:35:55 --- Train epoch-36, step-481 ---
2023-11-07 16:35:55 loss: 0.3166
2023-11-07 16:35:55 --- Eval epoch-36, step-481 ---
2023-11-07 16:35:55 pr_auc: 0.7786
2023-11-07 16:35:55 roc_auc: 0.7853
2023-11-07 16:35:55 f1: 0.7574
2023-11-07 16:35:55 loss: 0.7303
2023-11-07 16:35:55 
2023-11-07 16:35:55 --- Train epoch-37, step-494 ---
2023-11-07 16:35:55 loss: 0.3286
2023-11-07 16:35:55 --- Eval epoch-37, step-494 ---
2023-11-07 16:35:55 pr_auc: 0.7822
2023-11-07 16:35:55 roc_auc: 0.7887
2023-11-07 16:35:55 f1: 0.7692
2023-11-07 16:35:55 loss: 0.7193
2023-11-07 16:35:55 
2023-11-07 16:35:55 --- Train epoch-38, step-507 ---
2023-11-07 16:35:55 loss: 0.3320
2023-11-07 16:35:55 --- Eval epoch-38, step-507 ---
2023-11-07 16:35:55 pr_auc: 0.7817
2023-11-07 16:35:55 roc_auc: 0.7873
2023-11-07 16:35:55 f1: 0.7815
2023-11-07 16:35:55 loss: 0.7158
2023-11-07 16:35:55 
2023-11-07 16:35:56 --- Train epoch-39, step-520 ---
2023-11-07 16:35:56 loss: 0.3216
2023-11-07 16:35:56 --- Eval epoch-39, step-520 ---
2023-11-07 16:35:56 pr_auc: 0.7799
2023-11-07 16:35:56 roc_auc: 0.7842
2023-11-07 16:35:56 f1: 0.7679
2023-11-07 16:35:56 loss: 0.7424
2023-11-07 16:35:56 
2023-11-07 16:35:56 --- Train epoch-40, step-533 ---
2023-11-07 16:35:56 loss: 0.3284
2023-11-07 16:35:56 --- Eval epoch-40, step-533 ---
2023-11-07 16:35:56 pr_auc: 0.7819
2023-11-07 16:35:56 roc_auc: 0.7859
2023-11-07 16:35:56 f1: 0.7500
2023-11-07 16:35:56 loss: 0.7276
2023-11-07 16:35:56 
2023-11-07 16:35:56 --- Train epoch-41, step-546 ---
2023-11-07 16:35:56 loss: 0.3159
2023-11-07 16:35:57 --- Eval epoch-41, step-546 ---
2023-11-07 16:35:57 pr_auc: 0.7889
2023-11-07 16:35:57 roc_auc: 0.7916
2023-11-07 16:35:57 f1: 0.7619
2023-11-07 16:35:57 loss: 0.7126
2023-11-07 16:35:57 New best roc_auc score (0.7916) at epoch-41, step-546
2023-11-07 16:35:57 
2023-11-07 16:35:57 --- Train epoch-42, step-559 ---
2023-11-07 16:35:57 loss: 0.3195
2023-11-07 16:35:57 --- Eval epoch-42, step-559 ---
2023-11-07 16:35:57 pr_auc: 0.7902
2023-11-07 16:35:57 roc_auc: 0.7929
2023-11-07 16:35:57 f1: 0.7797
2023-11-07 16:35:57 loss: 0.7312
2023-11-07 16:35:57 New best roc_auc score (0.7929) at epoch-42, step-559
2023-11-07 16:35:57 
2023-11-07 16:35:57 --- Train epoch-43, step-572 ---
2023-11-07 16:35:57 loss: 0.3304
2023-11-07 16:35:57 --- Eval epoch-43, step-572 ---
2023-11-07 16:35:57 pr_auc: 0.7843
2023-11-07 16:35:57 roc_auc: 0.7904
2023-11-07 16:35:57 f1: 0.7660
2023-11-07 16:35:57 loss: 0.7527
2023-11-07 16:35:57 
2023-11-07 16:35:58 --- Train epoch-44, step-585 ---
2023-11-07 16:35:58 loss: 0.3248
2023-11-07 16:35:58 --- Eval epoch-44, step-585 ---
2023-11-07 16:35:58 pr_auc: 0.7781
2023-11-07 16:35:58 roc_auc: 0.7862
2023-11-07 16:35:58 f1: 0.7647
2023-11-07 16:35:58 loss: 0.7419
2023-11-07 16:35:58 
2023-11-07 16:35:58 --- Train epoch-45, step-598 ---
2023-11-07 16:35:58 loss: 0.3299
2023-11-07 16:35:58 --- Eval epoch-45, step-598 ---
2023-11-07 16:35:58 pr_auc: 0.7770
2023-11-07 16:35:58 roc_auc: 0.7835
2023-11-07 16:35:58 f1: 0.7815
2023-11-07 16:35:58 loss: 0.7586
2023-11-07 16:35:58 
2023-11-07 16:35:58 --- Train epoch-46, step-611 ---
2023-11-07 16:35:58 loss: 0.2997
2023-11-07 16:35:58 --- Eval epoch-46, step-611 ---
2023-11-07 16:35:58 pr_auc: 0.7733
2023-11-07 16:35:58 roc_auc: 0.7795
2023-11-07 16:35:58 f1: 0.7797
2023-11-07 16:35:58 loss: 0.7848
2023-11-07 16:35:58 
2023-11-07 16:35:58 --- Train epoch-47, step-624 ---
2023-11-07 16:35:58 loss: 0.3128
2023-11-07 16:35:58 --- Eval epoch-47, step-624 ---
2023-11-07 16:35:58 pr_auc: 0.7723
2023-11-07 16:35:58 roc_auc: 0.7788
2023-11-07 16:35:58 f1: 0.7660
2023-11-07 16:35:58 loss: 0.7979
2023-11-07 16:35:58 
2023-11-07 16:35:59 --- Train epoch-48, step-637 ---
2023-11-07 16:35:59 loss: 0.3214
2023-11-07 16:35:59 --- Eval epoch-48, step-637 ---
2023-11-07 16:35:59 pr_auc: 0.7781
2023-11-07 16:35:59 roc_auc: 0.7842
2023-11-07 16:35:59 f1: 0.7848
2023-11-07 16:35:59 loss: 0.7754
2023-11-07 16:35:59 
2023-11-07 16:35:59 --- Train epoch-49, step-650 ---
2023-11-07 16:35:59 loss: 0.3093
2023-11-07 16:35:59 --- Eval epoch-49, step-650 ---
2023-11-07 16:35:59 pr_auc: 0.7832
2023-11-07 16:35:59 roc_auc: 0.7888
2023-11-07 16:35:59 f1: 0.7815
2023-11-07 16:35:59 loss: 0.7533
2023-11-07 16:35:59 Loaded best model
2023-11-07 16:36:07 RNN(
  (embeddings): ModuleDict(
    (diagnoses): Embedding(601, 64, padding_idx=0)
  )
  (linear_layers): ModuleDict()
  (rnn): ModuleDict(
    (diagnoses): RNNLayer(
      (dropout_layer): Dropout(p=0.5, inplace=False)
      (rnn): LSTM(64, 64, num_layers=2, batch_first=True, dropout=0.5)
    )
  )
  (fc): Linear(in_features=64, out_features=1, bias=True)
)
2023-11-07 16:36:07 Metrics: ['pr_auc', 'roc_auc', 'f1']
2023-11-07 16:36:07 Device: cuda
2023-11-07 16:36:07 
2023-11-07 16:36:07 Training:
2023-11-07 16:36:07 Batch size: 64
2023-11-07 16:36:07 Optimizer: <class 'torch.optim.adam.Adam'>
2023-11-07 16:36:07 Optimizer params: {'lr': 0.001}
2023-11-07 16:36:07 Weight decay: 0.0
2023-11-07 16:36:07 Max grad norm: None
2023-11-07 16:36:07 Val dataloader: <torch.utils.data.dataloader.DataLoader object at 0x7fc77a395cd0>
2023-11-07 16:36:07 Monitor: roc_auc
2023-11-07 16:36:07 Monitor criterion: max
2023-11-07 16:36:07 Epochs: 20
2023-11-07 16:36:07 
2023-11-07 16:36:07 --- Train epoch-0, step-13 ---
2023-11-07 16:36:07 loss: 0.3050
2023-11-07 16:36:07 --- Eval epoch-0, step-13 ---
2023-11-07 16:36:07 pr_auc: 0.7836
2023-11-07 16:36:07 roc_auc: 0.7904
2023-11-07 16:36:07 f1: 0.7866
2023-11-07 16:36:07 loss: 0.7402
2023-11-07 16:36:07 New best roc_auc score (0.7904) at epoch-0, step-13
2023-11-07 16:36:07 
2023-11-07 16:36:08 --- Train epoch-1, step-26 ---
2023-11-07 16:36:08 loss: 0.3016
2023-11-07 16:36:08 --- Eval epoch-1, step-26 ---
2023-11-07 16:36:08 pr_auc: 0.7831
2023-11-07 16:36:08 roc_auc: 0.7907
2023-11-07 16:36:08 f1: 0.7607
2023-11-07 16:36:08 loss: 0.7541
2023-11-07 16:36:08 New best roc_auc score (0.7907) at epoch-1, step-26
2023-11-07 16:36:08 
2023-11-07 16:36:08 --- Train epoch-2, step-39 ---
2023-11-07 16:36:08 loss: 0.3256
2023-11-07 16:36:08 --- Eval epoch-2, step-39 ---
2023-11-07 16:36:08 pr_auc: 0.7828
2023-11-07 16:36:08 roc_auc: 0.7912
2023-11-07 16:36:08 f1: 0.7647
2023-11-07 16:36:08 loss: 0.7539
2023-11-07 16:36:08 New best roc_auc score (0.7912) at epoch-2, step-39
2023-11-07 16:36:08 
2023-11-07 16:36:08 --- Train epoch-3, step-52 ---
2023-11-07 16:36:08 loss: 0.3286
2023-11-07 16:36:08 --- Eval epoch-3, step-52 ---
2023-11-07 16:36:08 pr_auc: 0.7908
2023-11-07 16:36:08 roc_auc: 0.7948
2023-11-07 16:36:08 f1: 0.7725
2023-11-07 16:36:08 loss: 0.7108
2023-11-07 16:36:08 New best roc_auc score (0.7948) at epoch-3, step-52
2023-11-07 16:36:08 
2023-11-07 16:36:08 --- Train epoch-4, step-65 ---
2023-11-07 16:36:08 loss: 0.3262
2023-11-07 16:36:09 --- Eval epoch-4, step-65 ---
2023-11-07 16:36:09 pr_auc: 0.7877
2023-11-07 16:36:09 roc_auc: 0.7935
2023-11-07 16:36:09 f1: 0.7660
2023-11-07 16:36:09 loss: 0.7063
2023-11-07 16:36:09 
2023-11-07 16:36:09 --- Train epoch-5, step-78 ---
2023-11-07 16:36:09 loss: 0.3012
2023-11-07 16:36:09 --- Eval epoch-5, step-78 ---
2023-11-07 16:36:09 pr_auc: 0.7827
2023-11-07 16:36:09 roc_auc: 0.7916
2023-11-07 16:36:09 f1: 0.7692
2023-11-07 16:36:09 loss: 0.7315
2023-11-07 16:36:09 
2023-11-07 16:36:09 --- Train epoch-6, step-91 ---
2023-11-07 16:36:09 loss: 0.2876
2023-11-07 16:36:09 --- Eval epoch-6, step-91 ---
2023-11-07 16:36:09 pr_auc: 0.7812
2023-11-07 16:36:09 roc_auc: 0.7911
2023-11-07 16:36:09 f1: 0.7544
2023-11-07 16:36:09 loss: 0.7557
2023-11-07 16:36:09 
2023-11-07 16:36:09 --- Train epoch-7, step-104 ---
2023-11-07 16:36:09 loss: 0.3114
2023-11-07 16:36:09 --- Eval epoch-7, step-104 ---
2023-11-07 16:36:09 pr_auc: 0.7837
2023-11-07 16:36:09 roc_auc: 0.7915
2023-11-07 16:36:09 f1: 0.7686
2023-11-07 16:36:09 loss: 0.7538
2023-11-07 16:36:09 
2023-11-07 16:36:09 --- Train epoch-8, step-117 ---
2023-11-07 16:36:09 loss: 0.3055
2023-11-07 16:36:09 --- Eval epoch-8, step-117 ---
2023-11-07 16:36:09 pr_auc: 0.7876
2023-11-07 16:36:09 roc_auc: 0.7907
2023-11-07 16:36:09 f1: 0.7811
2023-11-07 16:36:09 loss: 0.7483
2023-11-07 16:36:09 
2023-11-07 16:36:09 --- Train epoch-9, step-130 ---
2023-11-07 16:36:09 loss: 0.2867
2023-11-07 16:36:09 --- Eval epoch-9, step-130 ---
2023-11-07 16:36:09 pr_auc: 0.7862
2023-11-07 16:36:09 roc_auc: 0.7909
2023-11-07 16:36:09 f1: 0.7706
2023-11-07 16:36:09 loss: 0.7532
2023-11-07 16:36:09 
2023-11-07 16:36:10 --- Train epoch-10, step-143 ---
2023-11-07 16:36:10 loss: 0.2821
2023-11-07 16:36:10 --- Eval epoch-10, step-143 ---
2023-11-07 16:36:10 pr_auc: 0.7894
2023-11-07 16:36:10 roc_auc: 0.7933
2023-11-07 16:36:10 f1: 0.7739
2023-11-07 16:36:10 loss: 0.7680
2023-11-07 16:36:10 
2023-11-07 16:36:10 --- Train epoch-11, step-156 ---
2023-11-07 16:36:10 loss: 0.2769
2023-11-07 16:36:10 --- Eval epoch-11, step-156 ---
2023-11-07 16:36:10 pr_auc: 0.7905
2023-11-07 16:36:10 roc_auc: 0.7957
2023-11-07 16:36:10 f1: 0.7739
2023-11-07 16:36:10 loss: 0.7590
2023-11-07 16:36:10 New best roc_auc score (0.7957) at epoch-11, step-156
2023-11-07 16:36:10 
2023-11-07 16:36:10 --- Train epoch-12, step-169 ---
2023-11-07 16:36:10 loss: 0.2795
2023-11-07 16:36:10 --- Eval epoch-12, step-169 ---
2023-11-07 16:36:10 pr_auc: 0.7947
2023-11-07 16:36:10 roc_auc: 0.7998
2023-11-07 16:36:10 f1: 0.7719
2023-11-07 16:36:10 loss: 0.7523
2023-11-07 16:36:10 New best roc_auc score (0.7998) at epoch-12, step-169
2023-11-07 16:36:10 
2023-11-07 16:36:10 --- Train epoch-13, step-182 ---
2023-11-07 16:36:10 loss: 0.3109
2023-11-07 16:36:10 --- Eval epoch-13, step-182 ---
2023-11-07 16:36:10 pr_auc: 0.7951
2023-11-07 16:36:10 roc_auc: 0.7987
2023-11-07 16:36:10 f1: 0.7686
2023-11-07 16:36:10 loss: 0.7286
2023-11-07 16:36:10 
2023-11-07 16:36:10 --- Train epoch-14, step-195 ---
2023-11-07 16:36:10 loss: 0.3129
2023-11-07 16:36:10 --- Eval epoch-14, step-195 ---
2023-11-07 16:36:10 pr_auc: 0.7876
2023-11-07 16:36:10 roc_auc: 0.7902
2023-11-07 16:36:10 f1: 0.7750
2023-11-07 16:36:10 loss: 0.7702
2023-11-07 16:36:10 
2023-11-07 16:36:11 --- Train epoch-15, step-208 ---
2023-11-07 16:36:11 loss: 0.2823
2023-11-07 16:36:11 --- Eval epoch-15, step-208 ---
2023-11-07 16:36:11 pr_auc: 0.7877
2023-11-07 16:36:11 roc_auc: 0.7887
2023-11-07 16:36:11 f1: 0.7586
2023-11-07 16:36:11 loss: 0.7471
2023-11-07 16:36:11 
2023-11-07 16:36:11 --- Train epoch-16, step-221 ---
2023-11-07 16:36:11 loss: 0.2709
2023-11-07 16:36:11 --- Eval epoch-16, step-221 ---
2023-11-07 16:36:11 pr_auc: 0.7785
2023-11-07 16:36:11 roc_auc: 0.7823
2023-11-07 16:36:11 f1: 0.7607
2023-11-07 16:36:11 loss: 0.7934
2023-11-07 16:36:11 
2023-11-07 16:36:11 --- Train epoch-17, step-234 ---
2023-11-07 16:36:11 loss: 0.2890
2023-11-07 16:36:11 --- Eval epoch-17, step-234 ---
2023-11-07 16:36:11 pr_auc: 0.7697
2023-11-07 16:36:11 roc_auc: 0.7789
2023-11-07 16:36:11 f1: 0.7554
2023-11-07 16:36:11 loss: 0.8180
2023-11-07 16:36:11 
2023-11-07 16:36:11 --- Train epoch-18, step-247 ---
2023-11-07 16:36:11 loss: 0.2629
2023-11-07 16:36:11 --- Eval epoch-18, step-247 ---
2023-11-07 16:36:11 pr_auc: 0.7633
2023-11-07 16:36:11 roc_auc: 0.7768
2023-11-07 16:36:11 f1: 0.7511
2023-11-07 16:36:11 loss: 0.8407
2023-11-07 16:36:11 
2023-11-07 16:36:11 --- Train epoch-19, step-260 ---
2023-11-07 16:36:11 loss: 0.2638
2023-11-07 16:36:11 --- Eval epoch-19, step-260 ---
2023-11-07 16:36:11 pr_auc: 0.7716
2023-11-07 16:36:11 roc_auc: 0.7761
2023-11-07 16:36:11 f1: 0.7404
2023-11-07 16:36:11 loss: 0.8047
2023-11-07 16:36:11 Loaded best model
