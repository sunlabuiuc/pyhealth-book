2024-01-25 13:38:47 RNN(
  (embeddings): ModuleDict(
    (diagnoses): Embedding(601, 64, padding_idx=0)
  )
  (linear_layers): ModuleDict()
  (rnn): ModuleDict(
    (diagnoses): RNNLayer(
      (dropout_layer): Dropout(p=0.5, inplace=False)
      (rnn): LSTM(64, 64, num_layers=2, batch_first=True, dropout=0.5)
    )
  )
  (fc): Linear(in_features=64, out_features=1, bias=True)
)
2024-01-25 13:38:47 Metrics: ['pr_auc', 'roc_auc', 'f1']
2024-01-25 13:38:47 Device: cuda
2024-01-25 13:38:47 
2024-01-25 13:38:47 Training:
2024-01-25 13:38:47 Batch size: 64
2024-01-25 13:38:47 Optimizer: <class 'torch.optim.adam.Adam'>
2024-01-25 13:38:47 Optimizer params: {'lr': 0.001}
2024-01-25 13:38:47 Weight decay: 0.0
2024-01-25 13:38:47 Max grad norm: None
2024-01-25 13:38:47 Val dataloader: <torch.utils.data.dataloader.DataLoader object at 0x7f6f60390370>
2024-01-25 13:38:47 Monitor: roc_auc
2024-01-25 13:38:47 Monitor criterion: max
2024-01-25 13:38:47 Epochs: 20
2024-01-25 13:38:47 
2024-01-25 13:38:49 --- Train epoch-0, step-13 ---
2024-01-25 13:38:49 loss: 0.6874
2024-01-25 13:38:49 --- Eval epoch-0, step-13 ---
2024-01-25 13:38:49 pr_auc: 0.6874
2024-01-25 13:38:49 roc_auc: 0.6813
2024-01-25 13:38:49 f1: 0.6890
2024-01-25 13:38:49 loss: 0.6897
2024-01-25 13:38:49 New best roc_auc score (0.6813) at epoch-0, step-13
2024-01-25 13:38:49 
2024-01-25 13:38:49 --- Train epoch-1, step-26 ---
2024-01-25 13:38:49 loss: 0.6797
2024-01-25 13:38:49 --- Eval epoch-1, step-26 ---
2024-01-25 13:38:49 pr_auc: 0.7509
2024-01-25 13:38:49 roc_auc: 0.7455
2024-01-25 13:38:49 f1: 0.6936
2024-01-25 13:38:49 loss: 0.6843
2024-01-25 13:38:49 New best roc_auc score (0.7455) at epoch-1, step-26
2024-01-25 13:38:49 
2024-01-25 13:38:49 --- Train epoch-2, step-39 ---
2024-01-25 13:38:49 loss: 0.6644
2024-01-25 13:38:49 --- Eval epoch-2, step-39 ---
2024-01-25 13:38:49 pr_auc: 0.7710
2024-01-25 13:38:49 roc_auc: 0.7651
2024-01-25 13:38:49 f1: 0.7108
2024-01-25 13:38:49 loss: 0.6764
2024-01-25 13:38:49 New best roc_auc score (0.7651) at epoch-2, step-39
2024-01-25 13:38:49 
2024-01-25 13:38:49 --- Train epoch-3, step-52 ---
2024-01-25 13:38:49 loss: 0.6478
2024-01-25 13:38:49 --- Eval epoch-3, step-52 ---
2024-01-25 13:38:49 pr_auc: 0.7785
2024-01-25 13:38:49 roc_auc: 0.7721
2024-01-25 13:38:49 f1: 0.7299
2024-01-25 13:38:49 loss: 0.6626
2024-01-25 13:38:49 New best roc_auc score (0.7721) at epoch-3, step-52
2024-01-25 13:38:49 
2024-01-25 13:38:49 --- Train epoch-4, step-65 ---
2024-01-25 13:38:49 loss: 0.6210
2024-01-25 13:38:49 --- Eval epoch-4, step-65 ---
2024-01-25 13:38:49 pr_auc: 0.7840
2024-01-25 13:38:49 roc_auc: 0.7794
2024-01-25 13:38:49 f1: 0.7597
2024-01-25 13:38:49 loss: 0.6477
2024-01-25 13:38:49 New best roc_auc score (0.7794) at epoch-4, step-65
2024-01-25 13:38:49 
2024-01-25 13:38:49 --- Train epoch-5, step-78 ---
2024-01-25 13:38:49 loss: 0.6049
2024-01-25 13:38:49 --- Eval epoch-5, step-78 ---
2024-01-25 13:38:49 pr_auc: 0.7861
2024-01-25 13:38:49 roc_auc: 0.7767
2024-01-25 13:38:49 f1: 0.7386
2024-01-25 13:38:49 loss: 0.6358
2024-01-25 13:38:49 
2024-01-25 13:38:50 --- Train epoch-6, step-91 ---
2024-01-25 13:38:50 loss: 0.5697
2024-01-25 13:38:50 --- Eval epoch-6, step-91 ---
2024-01-25 13:38:50 pr_auc: 0.7935
2024-01-25 13:38:50 roc_auc: 0.7774
2024-01-25 13:38:50 f1: 0.7074
2024-01-25 13:38:50 loss: 0.6524
2024-01-25 13:38:50 
2024-01-25 13:38:50 --- Train epoch-7, step-104 ---
2024-01-25 13:38:50 loss: 0.5443
2024-01-25 13:38:50 --- Eval epoch-7, step-104 ---
2024-01-25 13:38:50 pr_auc: 0.7910
2024-01-25 13:38:50 roc_auc: 0.7711
2024-01-25 13:38:50 f1: 0.7022
2024-01-25 13:38:50 loss: 0.7081
2024-01-25 13:38:50 
2024-01-25 13:38:50 --- Train epoch-8, step-117 ---
2024-01-25 13:38:50 loss: 0.5493
2024-01-25 13:38:50 --- Eval epoch-8, step-117 ---
2024-01-25 13:38:50 pr_auc: 0.7970
2024-01-25 13:38:50 roc_auc: 0.7800
2024-01-25 13:38:50 f1: 0.7280
2024-01-25 13:38:50 loss: 0.7188
2024-01-25 13:38:50 New best roc_auc score (0.7800) at epoch-8, step-117
2024-01-25 13:38:50 
2024-01-25 13:38:50 --- Train epoch-9, step-130 ---
2024-01-25 13:38:50 loss: 0.5281
2024-01-25 13:38:50 --- Eval epoch-9, step-130 ---
2024-01-25 13:38:50 pr_auc: 0.8022
2024-01-25 13:38:50 roc_auc: 0.7872
2024-01-25 13:38:50 f1: 0.7541
2024-01-25 13:38:50 loss: 0.6981
2024-01-25 13:38:50 New best roc_auc score (0.7872) at epoch-9, step-130
2024-01-25 13:38:50 
2024-01-25 13:38:50 --- Train epoch-10, step-143 ---
2024-01-25 13:38:50 loss: 0.5091
2024-01-25 13:38:50 --- Eval epoch-10, step-143 ---
2024-01-25 13:38:50 pr_auc: 0.7932
2024-01-25 13:38:50 roc_auc: 0.7752
2024-01-25 13:38:50 f1: 0.7074
2024-01-25 13:38:50 loss: 0.7020
2024-01-25 13:38:50 
2024-01-25 13:38:50 --- Train epoch-11, step-156 ---
2024-01-25 13:38:50 loss: 0.5120
2024-01-25 13:38:50 --- Eval epoch-11, step-156 ---
2024-01-25 13:38:50 pr_auc: 0.7983
2024-01-25 13:38:50 roc_auc: 0.7767
2024-01-25 13:38:50 f1: 0.7130
2024-01-25 13:38:50 loss: 0.7504
2024-01-25 13:38:50 
2024-01-25 13:38:51 --- Train epoch-12, step-169 ---
2024-01-25 13:38:51 loss: 0.4912
2024-01-25 13:38:51 --- Eval epoch-12, step-169 ---
2024-01-25 13:38:51 pr_auc: 0.8053
2024-01-25 13:38:51 roc_auc: 0.7853
2024-01-25 13:38:51 f1: 0.7426
2024-01-25 13:38:51 loss: 0.7604
2024-01-25 13:38:51 
2024-01-25 13:38:51 --- Train epoch-13, step-182 ---
2024-01-25 13:38:51 loss: 0.5067
2024-01-25 13:38:51 --- Eval epoch-13, step-182 ---
2024-01-25 13:38:51 pr_auc: 0.8072
2024-01-25 13:38:51 roc_auc: 0.7863
2024-01-25 13:38:51 f1: 0.7280
2024-01-25 13:38:51 loss: 0.7556
2024-01-25 13:38:51 
2024-01-25 13:38:51 --- Train epoch-14, step-195 ---
2024-01-25 13:38:51 loss: 0.4993
2024-01-25 13:38:51 --- Eval epoch-14, step-195 ---
2024-01-25 13:38:51 pr_auc: 0.8005
2024-01-25 13:38:51 roc_auc: 0.7790
2024-01-25 13:38:51 f1: 0.7273
2024-01-25 13:38:51 loss: 0.7670
2024-01-25 13:38:51 
2024-01-25 13:38:51 --- Train epoch-15, step-208 ---
2024-01-25 13:38:51 loss: 0.4842
2024-01-25 13:38:51 --- Eval epoch-15, step-208 ---
2024-01-25 13:38:51 pr_auc: 0.8028
2024-01-25 13:38:51 roc_auc: 0.7808
2024-01-25 13:38:51 f1: 0.7288
2024-01-25 13:38:51 loss: 0.7621
2024-01-25 13:38:51 
2024-01-25 13:38:51 --- Train epoch-16, step-221 ---
2024-01-25 13:38:51 loss: 0.4731
2024-01-25 13:38:51 --- Eval epoch-16, step-221 ---
2024-01-25 13:38:51 pr_auc: 0.8046
2024-01-25 13:38:51 roc_auc: 0.7832
2024-01-25 13:38:51 f1: 0.7227
2024-01-25 13:38:51 loss: 0.7614
2024-01-25 13:38:51 
2024-01-25 13:38:51 --- Train epoch-17, step-234 ---
2024-01-25 13:38:51 loss: 0.4886
2024-01-25 13:38:52 --- Eval epoch-17, step-234 ---
2024-01-25 13:38:52 pr_auc: 0.8033
2024-01-25 13:38:52 roc_auc: 0.7811
2024-01-25 13:38:52 f1: 0.7359
2024-01-25 13:38:52 loss: 0.7728
2024-01-25 13:38:52 
2024-01-25 13:38:52 --- Train epoch-18, step-247 ---
2024-01-25 13:38:52 loss: 0.4945
2024-01-25 13:38:52 --- Eval epoch-18, step-247 ---
2024-01-25 13:38:52 pr_auc: 0.8038
2024-01-25 13:38:52 roc_auc: 0.7843
2024-01-25 13:38:52 f1: 0.7395
2024-01-25 13:38:52 loss: 0.7313
2024-01-25 13:38:52 
2024-01-25 13:38:52 --- Train epoch-19, step-260 ---
2024-01-25 13:38:52 loss: 0.4679
2024-01-25 13:38:52 --- Eval epoch-19, step-260 ---
2024-01-25 13:38:52 pr_auc: 0.8077
2024-01-25 13:38:52 roc_auc: 0.7866
2024-01-25 13:38:52 f1: 0.7364
2024-01-25 13:38:52 loss: 0.7543
2024-01-25 13:38:52 Loaded best model
