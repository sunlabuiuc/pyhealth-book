2023-11-07 17:28:52 RNN(
  (embeddings): ModuleDict(
    (diagnoses): Embedding(601, 64, padding_idx=0)
  )
  (linear_layers): ModuleDict()
  (rnn): ModuleDict(
    (diagnoses): RNNLayer(
      (dropout_layer): Dropout(p=0.5, inplace=False)
      (rnn): LSTM(64, 64, num_layers=2, batch_first=True, dropout=0.5)
    )
  )
  (fc): Linear(in_features=64, out_features=1, bias=True)
)
2023-11-07 17:28:52 Metrics: ['pr_auc', 'roc_auc', 'f1']
2023-11-07 17:28:52 Device: cuda
2023-11-07 17:28:52 
2023-11-07 17:28:52 Training:
2023-11-07 17:28:52 Batch size: 64
2023-11-07 17:28:52 Optimizer: <class 'torch.optim.adam.Adam'>
2023-11-07 17:28:52 Optimizer params: {'lr': 0.001}
2023-11-07 17:28:52 Weight decay: 0.0
2023-11-07 17:28:52 Max grad norm: None
2023-11-07 17:28:52 Val dataloader: <torch.utils.data.dataloader.DataLoader object at 0x7f933d6add90>
2023-11-07 17:28:52 Monitor: roc_auc
2023-11-07 17:28:52 Monitor criterion: max
2023-11-07 17:28:52 Epochs: 20
2023-11-07 17:28:52 
2023-11-07 17:28:53 --- Train epoch-0, step-13 ---
2023-11-07 17:28:53 loss: 0.6889
2023-11-07 17:28:53 --- Eval epoch-0, step-13 ---
2023-11-07 17:28:53 pr_auc: 0.6721
2023-11-07 17:28:53 roc_auc: 0.6805
2023-11-07 17:28:53 f1: 0.6993
2023-11-07 17:28:53 loss: 0.6820
2023-11-07 17:28:53 New best roc_auc score (0.6805) at epoch-0, step-13
2023-11-07 17:28:53 
2023-11-07 17:28:53 --- Train epoch-1, step-26 ---
2023-11-07 17:28:53 loss: 0.6778
2023-11-07 17:28:53 --- Eval epoch-1, step-26 ---
2023-11-07 17:28:53 pr_auc: 0.6903
2023-11-07 17:28:53 roc_auc: 0.7080
2023-11-07 17:28:53 f1: 0.7114
2023-11-07 17:28:53 loss: 0.6673
2023-11-07 17:28:53 New best roc_auc score (0.7080) at epoch-1, step-26
2023-11-07 17:28:53 
2023-11-07 17:28:53 --- Train epoch-2, step-39 ---
2023-11-07 17:28:53 loss: 0.6681
2023-11-07 17:28:53 --- Eval epoch-2, step-39 ---
2023-11-07 17:28:53 pr_auc: 0.6957
2023-11-07 17:28:53 roc_auc: 0.7194
2023-11-07 17:28:53 f1: 0.7241
2023-11-07 17:28:53 loss: 0.6458
2023-11-07 17:28:53 New best roc_auc score (0.7194) at epoch-2, step-39
2023-11-07 17:28:53 
2023-11-07 17:28:53 --- Train epoch-3, step-52 ---
2023-11-07 17:28:53 loss: 0.6522
2023-11-07 17:28:53 --- Eval epoch-3, step-52 ---
2023-11-07 17:28:53 pr_auc: 0.7096
2023-11-07 17:28:53 roc_auc: 0.7310
2023-11-07 17:28:53 f1: 0.7365
2023-11-07 17:28:53 loss: 0.6176
2023-11-07 17:28:53 New best roc_auc score (0.7310) at epoch-3, step-52
2023-11-07 17:28:53 
2023-11-07 17:28:54 --- Train epoch-4, step-65 ---
2023-11-07 17:28:54 loss: 0.6313
2023-11-07 17:28:54 --- Eval epoch-4, step-65 ---
2023-11-07 17:28:54 pr_auc: 0.7104
2023-11-07 17:28:54 roc_auc: 0.7323
2023-11-07 17:28:54 f1: 0.7576
2023-11-07 17:28:54 loss: 0.5919
2023-11-07 17:28:54 New best roc_auc score (0.7323) at epoch-4, step-65
2023-11-07 17:28:54 
2023-11-07 17:28:54 --- Train epoch-5, step-78 ---
2023-11-07 17:28:54 loss: 0.6152
2023-11-07 17:28:54 --- Eval epoch-5, step-78 ---
2023-11-07 17:28:54 pr_auc: 0.7206
2023-11-07 17:28:54 roc_auc: 0.7361
2023-11-07 17:28:54 f1: 0.7360
2023-11-07 17:28:54 loss: 0.5673
2023-11-07 17:28:54 New best roc_auc score (0.7361) at epoch-5, step-78
2023-11-07 17:28:54 
2023-11-07 17:28:54 --- Train epoch-6, step-91 ---
2023-11-07 17:28:54 loss: 0.5898
2023-11-07 17:28:54 --- Eval epoch-6, step-91 ---
2023-11-07 17:28:54 pr_auc: 0.7347
2023-11-07 17:28:54 roc_auc: 0.7483
2023-11-07 17:28:54 f1: 0.7303
2023-11-07 17:28:54 loss: 0.5458
2023-11-07 17:28:54 New best roc_auc score (0.7483) at epoch-6, step-91
2023-11-07 17:28:54 
2023-11-07 17:28:54 --- Train epoch-7, step-104 ---
2023-11-07 17:28:54 loss: 0.5629
2023-11-07 17:28:54 --- Eval epoch-7, step-104 ---
2023-11-07 17:28:54 pr_auc: 0.7378
2023-11-07 17:28:54 roc_auc: 0.7527
2023-11-07 17:28:54 f1: 0.7364
2023-11-07 17:28:54 loss: 0.5317
2023-11-07 17:28:54 New best roc_auc score (0.7527) at epoch-7, step-104
2023-11-07 17:28:54 
2023-11-07 17:28:55 --- Train epoch-8, step-117 ---
2023-11-07 17:28:55 loss: 0.5589
2023-11-07 17:28:55 --- Eval epoch-8, step-117 ---
2023-11-07 17:28:55 pr_auc: 0.7656
2023-11-07 17:28:55 roc_auc: 0.7673
2023-11-07 17:28:55 f1: 0.7404
2023-11-07 17:28:55 loss: 0.5101
2023-11-07 17:28:55 New best roc_auc score (0.7673) at epoch-8, step-117
2023-11-07 17:28:55 
2023-11-07 17:28:55 --- Train epoch-9, step-130 ---
2023-11-07 17:28:55 loss: 0.5472
2023-11-07 17:28:55 --- Eval epoch-9, step-130 ---
2023-11-07 17:28:55 pr_auc: 0.7745
2023-11-07 17:28:55 roc_auc: 0.7733
2023-11-07 17:28:55 f1: 0.7552
2023-11-07 17:28:55 loss: 0.5079
2023-11-07 17:28:55 New best roc_auc score (0.7733) at epoch-9, step-130
2023-11-07 17:28:55 
2023-11-07 17:28:55 --- Train epoch-10, step-143 ---
2023-11-07 17:28:55 loss: 0.5463
2023-11-07 17:28:55 --- Eval epoch-10, step-143 ---
2023-11-07 17:28:55 pr_auc: 0.7879
2023-11-07 17:28:55 roc_auc: 0.7839
2023-11-07 17:28:55 f1: 0.7642
2023-11-07 17:28:55 loss: 0.5002
2023-11-07 17:28:55 New best roc_auc score (0.7839) at epoch-10, step-143
2023-11-07 17:28:55 
2023-11-07 17:28:55 --- Train epoch-11, step-156 ---
2023-11-07 17:28:55 loss: 0.5498
2023-11-07 17:28:55 --- Eval epoch-11, step-156 ---
2023-11-07 17:28:55 pr_auc: 0.7941
2023-11-07 17:28:55 roc_auc: 0.7882
2023-11-07 17:28:55 f1: 0.7686
2023-11-07 17:28:55 loss: 0.4904
2023-11-07 17:28:55 New best roc_auc score (0.7882) at epoch-11, step-156
2023-11-07 17:28:55 
2023-11-07 17:28:55 --- Train epoch-12, step-169 ---
2023-11-07 17:28:55 loss: 0.5162
2023-11-07 17:28:55 --- Eval epoch-12, step-169 ---
2023-11-07 17:28:55 pr_auc: 0.7973
2023-11-07 17:28:55 roc_auc: 0.7882
2023-11-07 17:28:55 f1: 0.7686
2023-11-07 17:28:55 loss: 0.4855
2023-11-07 17:28:55 
2023-11-07 17:28:56 --- Train epoch-13, step-182 ---
2023-11-07 17:28:56 loss: 0.5113
2023-11-07 17:28:56 --- Eval epoch-13, step-182 ---
2023-11-07 17:28:56 pr_auc: 0.7970
2023-11-07 17:28:56 roc_auc: 0.7880
2023-11-07 17:28:56 f1: 0.7635
2023-11-07 17:28:56 loss: 0.4821
2023-11-07 17:28:56 
2023-11-07 17:28:56 --- Train epoch-14, step-195 ---
2023-11-07 17:28:56 loss: 0.5085
2023-11-07 17:28:56 --- Eval epoch-14, step-195 ---
2023-11-07 17:28:56 pr_auc: 0.7967
2023-11-07 17:28:56 roc_auc: 0.7898
2023-11-07 17:28:56 f1: 0.7737
2023-11-07 17:28:56 loss: 0.4798
2023-11-07 17:28:56 New best roc_auc score (0.7898) at epoch-14, step-195
2023-11-07 17:28:56 
2023-11-07 17:28:56 --- Train epoch-15, step-208 ---
2023-11-07 17:28:56 loss: 0.5254
2023-11-07 17:28:56 --- Eval epoch-15, step-208 ---
2023-11-07 17:28:56 pr_auc: 0.7895
2023-11-07 17:28:56 roc_auc: 0.7894
2023-11-07 17:28:56 f1: 0.7692
2023-11-07 17:28:56 loss: 0.4850
2023-11-07 17:28:56 
2023-11-07 17:28:56 --- Train epoch-16, step-221 ---
2023-11-07 17:28:56 loss: 0.4883
2023-11-07 17:28:56 --- Eval epoch-16, step-221 ---
2023-11-07 17:28:56 pr_auc: 0.7896
2023-11-07 17:28:56 roc_auc: 0.7889
2023-11-07 17:28:56 f1: 0.7718
2023-11-07 17:28:56 loss: 0.4810
2023-11-07 17:28:56 
2023-11-07 17:28:56 --- Train epoch-17, step-234 ---
2023-11-07 17:28:56 loss: 0.4866
2023-11-07 17:28:57 --- Eval epoch-17, step-234 ---
2023-11-07 17:28:57 pr_auc: 0.7851
2023-11-07 17:28:57 roc_auc: 0.7879
2023-11-07 17:28:57 f1: 0.7755
2023-11-07 17:28:57 loss: 0.4894
2023-11-07 17:28:57 
2023-11-07 17:28:57 --- Train epoch-18, step-247 ---
2023-11-07 17:28:57 loss: 0.5024
2023-11-07 17:28:57 --- Eval epoch-18, step-247 ---
2023-11-07 17:28:57 pr_auc: 0.7900
2023-11-07 17:28:57 roc_auc: 0.7911
2023-11-07 17:28:57 f1: 0.7782
2023-11-07 17:28:57 loss: 0.4830
2023-11-07 17:28:57 New best roc_auc score (0.7911) at epoch-18, step-247
2023-11-07 17:28:57 
2023-11-07 17:28:57 --- Train epoch-19, step-260 ---
2023-11-07 17:28:57 loss: 0.4758
2023-11-07 17:28:57 --- Eval epoch-19, step-260 ---
2023-11-07 17:28:57 pr_auc: 0.7912
2023-11-07 17:28:57 roc_auc: 0.7926
2023-11-07 17:28:57 f1: 0.7737
2023-11-07 17:28:57 loss: 0.4866
2023-11-07 17:28:57 New best roc_auc score (0.7926) at epoch-19, step-260
2023-11-07 17:28:57 Loaded best model
