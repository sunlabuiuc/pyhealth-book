2023-11-27 00:28:27 RETAIN(
  (embeddings): ModuleDict(
    (diagnoses): Embedding(601, 128, padding_idx=0)
  )
  (linear_layers): ModuleDict()
  (retain): ModuleDict(
    (diagnoses): RETAINLayer(
      (dropout_layer): Dropout(p=0.5, inplace=False)
      (alpha_gru): GRU(128, 128, batch_first=True)
      (beta_gru): GRU(128, 128, batch_first=True)
      (alpha_li): Linear(in_features=128, out_features=1, bias=True)
      (beta_li): Linear(in_features=128, out_features=128, bias=True)
    )
  )
  (fc): Linear(in_features=128, out_features=1, bias=True)
)
2023-11-27 00:28:27 Metrics: ['pr_auc', 'roc_auc', 'f1']
2023-11-27 00:28:27 Device: cuda
2023-11-27 00:28:27 
2023-11-27 00:28:27 Training:
2023-11-27 00:28:27 Batch size: 64
2023-11-27 00:28:27 Optimizer: <class 'torch.optim.adam.Adam'>
2023-11-27 00:28:27 Optimizer params: {'lr': 0.001}
2023-11-27 00:28:27 Weight decay: 0.0
2023-11-27 00:28:27 Max grad norm: None
2023-11-27 00:28:27 Val dataloader: <torch.utils.data.dataloader.DataLoader object at 0x7fbe2f844520>
2023-11-27 00:28:27 Monitor: roc_auc
2023-11-27 00:28:27 Monitor criterion: max
2023-11-27 00:28:27 Epochs: 20
2023-11-27 00:28:27 
2023-11-27 00:28:27 --- Train epoch-0, step-13 ---
2023-11-27 00:28:27 loss: 0.6890
2023-11-27 00:28:27 --- Eval epoch-0, step-13 ---
2023-11-27 00:28:27 pr_auc: 0.6724
2023-11-27 00:28:27 roc_auc: 0.6552
2023-11-27 00:28:27 f1: 0.7080
2023-11-27 00:28:27 loss: 0.6754
2023-11-27 00:28:27 New best roc_auc score (0.6552) at epoch-0, step-13
2023-11-27 00:28:27 
2023-11-27 00:28:28 --- Train epoch-1, step-26 ---
2023-11-27 00:28:28 loss: 0.6443
2023-11-27 00:28:28 --- Eval epoch-1, step-26 ---
2023-11-27 00:28:28 pr_auc: 0.7390
2023-11-27 00:28:28 roc_auc: 0.7326
2023-11-27 00:28:28 f1: 0.7063
2023-11-27 00:28:28 loss: 0.6501
2023-11-27 00:28:28 New best roc_auc score (0.7326) at epoch-1, step-26
2023-11-27 00:28:28 
2023-11-27 00:28:28 --- Train epoch-2, step-39 ---
2023-11-27 00:28:28 loss: 0.6090
2023-11-27 00:28:28 --- Eval epoch-2, step-39 ---
2023-11-27 00:28:28 pr_auc: 0.7614
2023-11-27 00:28:28 roc_auc: 0.7647
2023-11-27 00:28:28 f1: 0.7300
2023-11-27 00:28:28 loss: 0.6397
2023-11-27 00:28:28 New best roc_auc score (0.7647) at epoch-2, step-39
2023-11-27 00:28:28 
2023-11-27 00:28:28 --- Train epoch-3, step-52 ---
2023-11-27 00:28:28 loss: 0.5938
2023-11-27 00:28:29 --- Eval epoch-3, step-52 ---
2023-11-27 00:28:29 pr_auc: 0.7655
2023-11-27 00:28:29 roc_auc: 0.7755
2023-11-27 00:28:29 f1: 0.7603
2023-11-27 00:28:29 loss: 0.5997
2023-11-27 00:28:29 New best roc_auc score (0.7755) at epoch-3, step-52
2023-11-27 00:28:29 
2023-11-27 00:28:29 --- Train epoch-4, step-65 ---
2023-11-27 00:28:29 loss: 0.5551
2023-11-27 00:28:29 --- Eval epoch-4, step-65 ---
2023-11-27 00:28:29 pr_auc: 0.7727
2023-11-27 00:28:29 roc_auc: 0.7817
2023-11-27 00:28:29 f1: 0.7932
2023-11-27 00:28:29 loss: 0.5812
2023-11-27 00:28:29 New best roc_auc score (0.7817) at epoch-4, step-65
2023-11-27 00:28:29 
2023-11-27 00:28:29 --- Train epoch-5, step-78 ---
2023-11-27 00:28:29 loss: 0.5247
2023-11-27 00:28:29 --- Eval epoch-5, step-78 ---
2023-11-27 00:28:29 pr_auc: 0.7756
2023-11-27 00:28:29 roc_auc: 0.7847
2023-11-27 00:28:29 f1: 0.7860
2023-11-27 00:28:29 loss: 0.5772
2023-11-27 00:28:29 New best roc_auc score (0.7847) at epoch-5, step-78
2023-11-27 00:28:29 
2023-11-27 00:28:29 --- Train epoch-6, step-91 ---
2023-11-27 00:28:29 loss: 0.4954
2023-11-27 00:28:29 --- Eval epoch-6, step-91 ---
2023-11-27 00:28:29 pr_auc: 0.7808
2023-11-27 00:28:29 roc_auc: 0.7949
2023-11-27 00:28:29 f1: 0.8018
2023-11-27 00:28:29 loss: 0.5632
2023-11-27 00:28:29 New best roc_auc score (0.7949) at epoch-6, step-91
2023-11-27 00:28:29 
2023-11-27 00:28:30 --- Train epoch-7, step-104 ---
2023-11-27 00:28:30 loss: 0.4877
2023-11-27 00:28:30 --- Eval epoch-7, step-104 ---
2023-11-27 00:28:30 pr_auc: 0.7768
2023-11-27 00:28:30 roc_auc: 0.7962
2023-11-27 00:28:30 f1: 0.7822
2023-11-27 00:28:30 loss: 0.5572
2023-11-27 00:28:30 New best roc_auc score (0.7962) at epoch-7, step-104
2023-11-27 00:28:30 
2023-11-27 00:28:30 --- Train epoch-8, step-117 ---
2023-11-27 00:28:30 loss: 0.4586
2023-11-27 00:28:30 --- Eval epoch-8, step-117 ---
2023-11-27 00:28:30 pr_auc: 0.7647
2023-11-27 00:28:30 roc_auc: 0.7842
2023-11-27 00:28:30 f1: 0.7580
2023-11-27 00:28:30 loss: 0.5577
2023-11-27 00:28:30 
2023-11-27 00:28:30 --- Train epoch-9, step-130 ---
2023-11-27 00:28:30 loss: 0.4280
2023-11-27 00:28:30 --- Eval epoch-9, step-130 ---
2023-11-27 00:28:30 pr_auc: 0.7607
2023-11-27 00:28:30 roc_auc: 0.7788
2023-11-27 00:28:30 f1: 0.7580
2023-11-27 00:28:30 loss: 0.5780
2023-11-27 00:28:30 
2023-11-27 00:28:31 --- Train epoch-10, step-143 ---
2023-11-27 00:28:31 loss: 0.3954
2023-11-27 00:28:31 --- Eval epoch-10, step-143 ---
2023-11-27 00:28:31 pr_auc: 0.7648
2023-11-27 00:28:31 roc_auc: 0.7750
2023-11-27 00:28:31 f1: 0.7545
2023-11-27 00:28:31 loss: 0.5786
2023-11-27 00:28:31 
2023-11-27 00:28:31 --- Train epoch-11, step-156 ---
2023-11-27 00:28:31 loss: 0.3829
2023-11-27 00:28:31 --- Eval epoch-11, step-156 ---
2023-11-27 00:28:31 pr_auc: 0.7759
2023-11-27 00:28:31 roc_auc: 0.7856
2023-11-27 00:28:31 f1: 0.7523
2023-11-27 00:28:31 loss: 0.5592
2023-11-27 00:28:31 
2023-11-27 00:28:31 --- Train epoch-12, step-169 ---
2023-11-27 00:28:31 loss: 0.3781
2023-11-27 00:28:31 --- Eval epoch-12, step-169 ---
2023-11-27 00:28:31 pr_auc: 0.7788
2023-11-27 00:28:31 roc_auc: 0.7907
2023-11-27 00:28:31 f1: 0.7489
2023-11-27 00:28:31 loss: 0.5554
2023-11-27 00:28:31 
2023-11-27 00:28:31 --- Train epoch-13, step-182 ---
2023-11-27 00:28:31 loss: 0.3242
2023-11-27 00:28:31 --- Eval epoch-13, step-182 ---
2023-11-27 00:28:31 pr_auc: 0.7844
2023-11-27 00:28:31 roc_auc: 0.7903
2023-11-27 00:28:31 f1: 0.7373
2023-11-27 00:28:31 loss: 0.5529
2023-11-27 00:28:31 
2023-11-27 00:28:32 --- Train epoch-14, step-195 ---
2023-11-27 00:28:32 loss: 0.3310
2023-11-27 00:28:32 --- Eval epoch-14, step-195 ---
2023-11-27 00:28:32 pr_auc: 0.7806
2023-11-27 00:28:32 roc_auc: 0.7952
2023-11-27 00:28:32 f1: 0.7290
2023-11-27 00:28:32 loss: 0.5647
2023-11-27 00:28:32 
2023-11-27 00:28:32 --- Train epoch-15, step-208 ---
2023-11-27 00:28:32 loss: 0.2925
2023-11-27 00:28:32 --- Eval epoch-15, step-208 ---
2023-11-27 00:28:32 pr_auc: 0.7746
2023-11-27 00:28:32 roc_auc: 0.7932
2023-11-27 00:28:32 f1: 0.7489
2023-11-27 00:28:32 loss: 0.5785
2023-11-27 00:28:32 
2023-11-27 00:28:32 --- Train epoch-16, step-221 ---
2023-11-27 00:28:32 loss: 0.2872
2023-11-27 00:28:32 --- Eval epoch-16, step-221 ---
2023-11-27 00:28:32 pr_auc: 0.7843
2023-11-27 00:28:32 roc_auc: 0.7942
2023-11-27 00:28:32 f1: 0.7421
2023-11-27 00:28:32 loss: 0.6026
2023-11-27 00:28:32 
2023-11-27 00:28:32 --- Train epoch-17, step-234 ---
2023-11-27 00:28:32 loss: 0.2841
2023-11-27 00:28:32 --- Eval epoch-17, step-234 ---
2023-11-27 00:28:32 pr_auc: 0.7776
2023-11-27 00:28:32 roc_auc: 0.7883
2023-11-27 00:28:32 f1: 0.7364
2023-11-27 00:28:32 loss: 0.6263
2023-11-27 00:28:32 
2023-11-27 00:28:33 --- Train epoch-18, step-247 ---
2023-11-27 00:28:33 loss: 0.2695
2023-11-27 00:28:33 --- Eval epoch-18, step-247 ---
2023-11-27 00:28:33 pr_auc: 0.7726
2023-11-27 00:28:33 roc_auc: 0.7843
2023-11-27 00:28:33 f1: 0.7453
2023-11-27 00:28:33 loss: 0.6259
2023-11-27 00:28:33 
2023-11-27 00:28:33 --- Train epoch-19, step-260 ---
2023-11-27 00:28:33 loss: 0.2427
2023-11-27 00:28:33 --- Eval epoch-19, step-260 ---
2023-11-27 00:28:33 pr_auc: 0.7767
2023-11-27 00:28:33 roc_auc: 0.7861
2023-11-27 00:28:33 f1: 0.7407
2023-11-27 00:28:33 loss: 0.6537
2023-11-27 00:28:33 Loaded best model
