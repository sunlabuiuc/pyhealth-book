2023-11-07 16:36:07 RNN(
  (embeddings): ModuleDict(
    (diagnoses): Embedding(601, 64, padding_idx=0)
  )
  (linear_layers): ModuleDict()
  (rnn): ModuleDict(
    (diagnoses): RNNLayer(
      (dropout_layer): Dropout(p=0.5, inplace=False)
      (rnn): LSTM(64, 64, num_layers=2, batch_first=True, dropout=0.5)
    )
  )
  (fc): Linear(in_features=64, out_features=1, bias=True)
)
2023-11-07 16:36:07 Metrics: ['pr_auc', 'roc_auc', 'f1']
2023-11-07 16:36:07 Device: cuda
2023-11-07 16:36:07 
2023-11-07 16:36:07 Training:
2023-11-07 16:36:07 Batch size: 64
2023-11-07 16:36:07 Optimizer: <class 'torch.optim.adam.Adam'>
2023-11-07 16:36:07 Optimizer params: {'lr': 0.001}
2023-11-07 16:36:07 Weight decay: 0.0
2023-11-07 16:36:07 Max grad norm: None
2023-11-07 16:36:07 Val dataloader: <torch.utils.data.dataloader.DataLoader object at 0x7fc77a395cd0>
2023-11-07 16:36:07 Monitor: roc_auc
2023-11-07 16:36:07 Monitor criterion: max
2023-11-07 16:36:07 Epochs: 20
2023-11-07 16:36:07 
2023-11-07 16:36:07 --- Train epoch-0, step-13 ---
2023-11-07 16:36:07 loss: 0.3050
2023-11-07 16:36:07 --- Eval epoch-0, step-13 ---
2023-11-07 16:36:07 pr_auc: 0.7836
2023-11-07 16:36:07 roc_auc: 0.7904
2023-11-07 16:36:07 f1: 0.7866
2023-11-07 16:36:07 loss: 0.7402
2023-11-07 16:36:07 New best roc_auc score (0.7904) at epoch-0, step-13
2023-11-07 16:36:07 
2023-11-07 16:36:08 --- Train epoch-1, step-26 ---
2023-11-07 16:36:08 loss: 0.3016
2023-11-07 16:36:08 --- Eval epoch-1, step-26 ---
2023-11-07 16:36:08 pr_auc: 0.7831
2023-11-07 16:36:08 roc_auc: 0.7907
2023-11-07 16:36:08 f1: 0.7607
2023-11-07 16:36:08 loss: 0.7541
2023-11-07 16:36:08 New best roc_auc score (0.7907) at epoch-1, step-26
2023-11-07 16:36:08 
2023-11-07 16:36:08 --- Train epoch-2, step-39 ---
2023-11-07 16:36:08 loss: 0.3256
2023-11-07 16:36:08 --- Eval epoch-2, step-39 ---
2023-11-07 16:36:08 pr_auc: 0.7828
2023-11-07 16:36:08 roc_auc: 0.7912
2023-11-07 16:36:08 f1: 0.7647
2023-11-07 16:36:08 loss: 0.7539
2023-11-07 16:36:08 New best roc_auc score (0.7912) at epoch-2, step-39
2023-11-07 16:36:08 
2023-11-07 16:36:08 --- Train epoch-3, step-52 ---
2023-11-07 16:36:08 loss: 0.3286
2023-11-07 16:36:08 --- Eval epoch-3, step-52 ---
2023-11-07 16:36:08 pr_auc: 0.7908
2023-11-07 16:36:08 roc_auc: 0.7948
2023-11-07 16:36:08 f1: 0.7725
2023-11-07 16:36:08 loss: 0.7108
2023-11-07 16:36:08 New best roc_auc score (0.7948) at epoch-3, step-52
2023-11-07 16:36:08 
2023-11-07 16:36:08 --- Train epoch-4, step-65 ---
2023-11-07 16:36:08 loss: 0.3262
2023-11-07 16:36:09 --- Eval epoch-4, step-65 ---
2023-11-07 16:36:09 pr_auc: 0.7877
2023-11-07 16:36:09 roc_auc: 0.7935
2023-11-07 16:36:09 f1: 0.7660
2023-11-07 16:36:09 loss: 0.7063
2023-11-07 16:36:09 
2023-11-07 16:36:09 --- Train epoch-5, step-78 ---
2023-11-07 16:36:09 loss: 0.3012
2023-11-07 16:36:09 --- Eval epoch-5, step-78 ---
2023-11-07 16:36:09 pr_auc: 0.7827
2023-11-07 16:36:09 roc_auc: 0.7916
2023-11-07 16:36:09 f1: 0.7692
2023-11-07 16:36:09 loss: 0.7315
2023-11-07 16:36:09 
2023-11-07 16:36:09 --- Train epoch-6, step-91 ---
2023-11-07 16:36:09 loss: 0.2876
2023-11-07 16:36:09 --- Eval epoch-6, step-91 ---
2023-11-07 16:36:09 pr_auc: 0.7812
2023-11-07 16:36:09 roc_auc: 0.7911
2023-11-07 16:36:09 f1: 0.7544
2023-11-07 16:36:09 loss: 0.7557
2023-11-07 16:36:09 
2023-11-07 16:36:09 --- Train epoch-7, step-104 ---
2023-11-07 16:36:09 loss: 0.3114
2023-11-07 16:36:09 --- Eval epoch-7, step-104 ---
2023-11-07 16:36:09 pr_auc: 0.7837
2023-11-07 16:36:09 roc_auc: 0.7915
2023-11-07 16:36:09 f1: 0.7686
2023-11-07 16:36:09 loss: 0.7538
2023-11-07 16:36:09 
2023-11-07 16:36:09 --- Train epoch-8, step-117 ---
2023-11-07 16:36:09 loss: 0.3055
2023-11-07 16:36:09 --- Eval epoch-8, step-117 ---
2023-11-07 16:36:09 pr_auc: 0.7876
2023-11-07 16:36:09 roc_auc: 0.7907
2023-11-07 16:36:09 f1: 0.7811
2023-11-07 16:36:09 loss: 0.7483
2023-11-07 16:36:09 
2023-11-07 16:36:09 --- Train epoch-9, step-130 ---
2023-11-07 16:36:09 loss: 0.2867
2023-11-07 16:36:09 --- Eval epoch-9, step-130 ---
2023-11-07 16:36:09 pr_auc: 0.7862
2023-11-07 16:36:09 roc_auc: 0.7909
2023-11-07 16:36:09 f1: 0.7706
2023-11-07 16:36:09 loss: 0.7532
2023-11-07 16:36:09 
2023-11-07 16:36:10 --- Train epoch-10, step-143 ---
2023-11-07 16:36:10 loss: 0.2821
2023-11-07 16:36:10 --- Eval epoch-10, step-143 ---
2023-11-07 16:36:10 pr_auc: 0.7894
2023-11-07 16:36:10 roc_auc: 0.7933
2023-11-07 16:36:10 f1: 0.7739
2023-11-07 16:36:10 loss: 0.7680
2023-11-07 16:36:10 
2023-11-07 16:36:10 --- Train epoch-11, step-156 ---
2023-11-07 16:36:10 loss: 0.2769
2023-11-07 16:36:10 --- Eval epoch-11, step-156 ---
2023-11-07 16:36:10 pr_auc: 0.7905
2023-11-07 16:36:10 roc_auc: 0.7957
2023-11-07 16:36:10 f1: 0.7739
2023-11-07 16:36:10 loss: 0.7590
2023-11-07 16:36:10 New best roc_auc score (0.7957) at epoch-11, step-156
2023-11-07 16:36:10 
2023-11-07 16:36:10 --- Train epoch-12, step-169 ---
2023-11-07 16:36:10 loss: 0.2795
2023-11-07 16:36:10 --- Eval epoch-12, step-169 ---
2023-11-07 16:36:10 pr_auc: 0.7947
2023-11-07 16:36:10 roc_auc: 0.7998
2023-11-07 16:36:10 f1: 0.7719
2023-11-07 16:36:10 loss: 0.7523
2023-11-07 16:36:10 New best roc_auc score (0.7998) at epoch-12, step-169
2023-11-07 16:36:10 
2023-11-07 16:36:10 --- Train epoch-13, step-182 ---
2023-11-07 16:36:10 loss: 0.3109
2023-11-07 16:36:10 --- Eval epoch-13, step-182 ---
2023-11-07 16:36:10 pr_auc: 0.7951
2023-11-07 16:36:10 roc_auc: 0.7987
2023-11-07 16:36:10 f1: 0.7686
2023-11-07 16:36:10 loss: 0.7286
2023-11-07 16:36:10 
2023-11-07 16:36:10 --- Train epoch-14, step-195 ---
2023-11-07 16:36:10 loss: 0.3129
2023-11-07 16:36:10 --- Eval epoch-14, step-195 ---
2023-11-07 16:36:10 pr_auc: 0.7876
2023-11-07 16:36:10 roc_auc: 0.7902
2023-11-07 16:36:10 f1: 0.7750
2023-11-07 16:36:10 loss: 0.7702
2023-11-07 16:36:10 
2023-11-07 16:36:11 --- Train epoch-15, step-208 ---
2023-11-07 16:36:11 loss: 0.2823
2023-11-07 16:36:11 --- Eval epoch-15, step-208 ---
2023-11-07 16:36:11 pr_auc: 0.7877
2023-11-07 16:36:11 roc_auc: 0.7887
2023-11-07 16:36:11 f1: 0.7586
2023-11-07 16:36:11 loss: 0.7471
2023-11-07 16:36:11 
2023-11-07 16:36:11 --- Train epoch-16, step-221 ---
2023-11-07 16:36:11 loss: 0.2709
2023-11-07 16:36:11 --- Eval epoch-16, step-221 ---
2023-11-07 16:36:11 pr_auc: 0.7785
2023-11-07 16:36:11 roc_auc: 0.7823
2023-11-07 16:36:11 f1: 0.7607
2023-11-07 16:36:11 loss: 0.7934
2023-11-07 16:36:11 
2023-11-07 16:36:11 --- Train epoch-17, step-234 ---
2023-11-07 16:36:11 loss: 0.2890
2023-11-07 16:36:11 --- Eval epoch-17, step-234 ---
2023-11-07 16:36:11 pr_auc: 0.7697
2023-11-07 16:36:11 roc_auc: 0.7789
2023-11-07 16:36:11 f1: 0.7554
2023-11-07 16:36:11 loss: 0.8180
2023-11-07 16:36:11 
2023-11-07 16:36:11 --- Train epoch-18, step-247 ---
2023-11-07 16:36:11 loss: 0.2629
2023-11-07 16:36:11 --- Eval epoch-18, step-247 ---
2023-11-07 16:36:11 pr_auc: 0.7633
2023-11-07 16:36:11 roc_auc: 0.7768
2023-11-07 16:36:11 f1: 0.7511
2023-11-07 16:36:11 loss: 0.8407
2023-11-07 16:36:11 
2023-11-07 16:36:11 --- Train epoch-19, step-260 ---
2023-11-07 16:36:11 loss: 0.2638
2023-11-07 16:36:11 --- Eval epoch-19, step-260 ---
2023-11-07 16:36:11 pr_auc: 0.7716
2023-11-07 16:36:11 roc_auc: 0.7761
2023-11-07 16:36:11 f1: 0.7404
2023-11-07 16:36:11 loss: 0.8047
2023-11-07 16:36:11 Loaded best model
