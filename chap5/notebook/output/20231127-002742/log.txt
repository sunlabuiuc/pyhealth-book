2023-11-27 00:27:43 RETAIN(
  (embeddings): ModuleDict(
    (diagnoses): Embedding(601, 64, padding_idx=0)
  )
  (linear_layers): ModuleDict()
  (retain): ModuleDict(
    (diagnoses): RETAINLayer(
      (dropout_layer): Dropout(p=0.5, inplace=False)
      (alpha_gru): GRU(64, 64, batch_first=True)
      (beta_gru): GRU(64, 64, batch_first=True)
      (alpha_li): Linear(in_features=64, out_features=1, bias=True)
      (beta_li): Linear(in_features=64, out_features=64, bias=True)
    )
  )
  (fc): Linear(in_features=64, out_features=1, bias=True)
)
2023-11-27 00:27:43 Metrics: ['pr_auc', 'roc_auc', 'f1']
2023-11-27 00:27:43 Device: cuda
2023-11-27 00:27:43 
2023-11-27 00:27:43 Training:
2023-11-27 00:27:43 Batch size: 64
2023-11-27 00:27:43 Optimizer: <class 'torch.optim.adam.Adam'>
2023-11-27 00:27:43 Optimizer params: {'lr': 0.001}
2023-11-27 00:27:43 Weight decay: 0.0
2023-11-27 00:27:43 Max grad norm: None
2023-11-27 00:27:43 Val dataloader: <torch.utils.data.dataloader.DataLoader object at 0x7fbe2f844520>
2023-11-27 00:27:43 Monitor: roc_auc
2023-11-27 00:27:43 Monitor criterion: max
2023-11-27 00:27:43 Epochs: 20
2023-11-27 00:27:43 
2023-11-27 00:27:44 --- Train epoch-0, step-13 ---
2023-11-27 00:27:44 loss: 0.6933
2023-11-27 00:27:44 --- Eval epoch-0, step-13 ---
2023-11-27 00:27:44 pr_auc: 0.6470
2023-11-27 00:27:44 roc_auc: 0.6400
2023-11-27 00:27:44 f1: 0.6957
2023-11-27 00:27:44 loss: 0.6589
2023-11-27 00:27:44 New best roc_auc score (0.6400) at epoch-0, step-13
2023-11-27 00:27:44 
2023-11-27 00:27:44 --- Train epoch-1, step-26 ---
2023-11-27 00:27:44 loss: 0.6740
2023-11-27 00:27:44 --- Eval epoch-1, step-26 ---
2023-11-27 00:27:44 pr_auc: 0.6836
2023-11-27 00:27:44 roc_auc: 0.6875
2023-11-27 00:27:44 f1: 0.7200
2023-11-27 00:27:44 loss: 0.6452
2023-11-27 00:27:44 New best roc_auc score (0.6875) at epoch-1, step-26
2023-11-27 00:27:44 
2023-11-27 00:27:44 --- Train epoch-2, step-39 ---
2023-11-27 00:27:44 loss: 0.6405
2023-11-27 00:27:44 --- Eval epoch-2, step-39 ---
2023-11-27 00:27:44 pr_auc: 0.7044
2023-11-27 00:27:44 roc_auc: 0.7056
2023-11-27 00:27:44 f1: 0.7500
2023-11-27 00:27:44 loss: 0.6290
2023-11-27 00:27:44 New best roc_auc score (0.7056) at epoch-2, step-39
2023-11-27 00:27:44 
2023-11-27 00:27:45 --- Train epoch-3, step-52 ---
2023-11-27 00:27:45 loss: 0.6331
2023-11-27 00:27:45 --- Eval epoch-3, step-52 ---
2023-11-27 00:27:45 pr_auc: 0.7193
2023-11-27 00:27:45 roc_auc: 0.7161
2023-11-27 00:27:45 f1: 0.7586
2023-11-27 00:27:45 loss: 0.6167
2023-11-27 00:27:45 New best roc_auc score (0.7161) at epoch-3, step-52
2023-11-27 00:27:45 
2023-11-27 00:27:45 --- Train epoch-4, step-65 ---
2023-11-27 00:27:45 loss: 0.6190
2023-11-27 00:27:45 --- Eval epoch-4, step-65 ---
2023-11-27 00:27:45 pr_auc: 0.7346
2023-11-27 00:27:45 roc_auc: 0.7299
2023-11-27 00:27:45 f1: 0.7500
2023-11-27 00:27:45 loss: 0.6006
2023-11-27 00:27:45 New best roc_auc score (0.7299) at epoch-4, step-65
2023-11-27 00:27:45 
2023-11-27 00:27:45 --- Train epoch-5, step-78 ---
2023-11-27 00:27:45 loss: 0.6109
2023-11-27 00:27:45 --- Eval epoch-5, step-78 ---
2023-11-27 00:27:45 pr_auc: 0.7466
2023-11-27 00:27:45 roc_auc: 0.7417
2023-11-27 00:27:45 f1: 0.7460
2023-11-27 00:27:45 loss: 0.5863
2023-11-27 00:27:45 New best roc_auc score (0.7417) at epoch-5, step-78
2023-11-27 00:27:45 
2023-11-27 00:27:46 --- Train epoch-6, step-91 ---
2023-11-27 00:27:46 loss: 0.5965
2023-11-27 00:27:46 --- Eval epoch-6, step-91 ---
2023-11-27 00:27:46 pr_auc: 0.7535
2023-11-27 00:27:46 roc_auc: 0.7558
2023-11-27 00:27:46 f1: 0.7550
2023-11-27 00:27:46 loss: 0.5747
2023-11-27 00:27:46 New best roc_auc score (0.7558) at epoch-6, step-91
2023-11-27 00:27:46 
2023-11-27 00:27:46 --- Train epoch-7, step-104 ---
2023-11-27 00:27:46 loss: 0.5917
2023-11-27 00:27:46 --- Eval epoch-7, step-104 ---
2023-11-27 00:27:46 pr_auc: 0.7615
2023-11-27 00:27:46 roc_auc: 0.7661
2023-11-27 00:27:46 f1: 0.7673
2023-11-27 00:27:46 loss: 0.5678
2023-11-27 00:27:46 New best roc_auc score (0.7661) at epoch-7, step-104
2023-11-27 00:27:46 
2023-11-27 00:27:46 --- Train epoch-8, step-117 ---
2023-11-27 00:27:46 loss: 0.5965
2023-11-27 00:27:46 --- Eval epoch-8, step-117 ---
2023-11-27 00:27:46 pr_auc: 0.7650
2023-11-27 00:27:46 roc_auc: 0.7707
2023-11-27 00:27:46 f1: 0.7572
2023-11-27 00:27:46 loss: 0.5643
2023-11-27 00:27:46 New best roc_auc score (0.7707) at epoch-8, step-117
2023-11-27 00:27:46 
2023-11-27 00:27:46 --- Train epoch-9, step-130 ---
2023-11-27 00:27:46 loss: 0.5572
2023-11-27 00:27:46 --- Eval epoch-9, step-130 ---
2023-11-27 00:27:46 pr_auc: 0.7686
2023-11-27 00:27:46 roc_auc: 0.7711
2023-11-27 00:27:46 f1: 0.7615
2023-11-27 00:27:46 loss: 0.5577
2023-11-27 00:27:46 New best roc_auc score (0.7711) at epoch-9, step-130
2023-11-27 00:27:46 
2023-11-27 00:27:47 --- Train epoch-10, step-143 ---
2023-11-27 00:27:47 loss: 0.5631
2023-11-27 00:27:47 --- Eval epoch-10, step-143 ---
2023-11-27 00:27:47 pr_auc: 0.7671
2023-11-27 00:27:47 roc_auc: 0.7724
2023-11-27 00:27:47 f1: 0.7500
2023-11-27 00:27:47 loss: 0.5546
2023-11-27 00:27:47 New best roc_auc score (0.7724) at epoch-10, step-143
2023-11-27 00:27:47 
2023-11-27 00:27:47 --- Train epoch-11, step-156 ---
2023-11-27 00:27:47 loss: 0.5396
2023-11-27 00:27:47 --- Eval epoch-11, step-156 ---
2023-11-27 00:27:47 pr_auc: 0.7637
2023-11-27 00:27:47 roc_auc: 0.7727
2023-11-27 00:27:47 f1: 0.7718
2023-11-27 00:27:47 loss: 0.5555
2023-11-27 00:27:47 New best roc_auc score (0.7727) at epoch-11, step-156
2023-11-27 00:27:47 
2023-11-27 00:27:47 --- Train epoch-12, step-169 ---
2023-11-27 00:27:47 loss: 0.5219
2023-11-27 00:27:47 --- Eval epoch-12, step-169 ---
2023-11-27 00:27:47 pr_auc: 0.7639
2023-11-27 00:27:47 roc_auc: 0.7726
2023-11-27 00:27:47 f1: 0.7615
2023-11-27 00:27:47 loss: 0.5500
2023-11-27 00:27:47 
2023-11-27 00:27:48 --- Train epoch-13, step-182 ---
2023-11-27 00:27:48 loss: 0.5291
2023-11-27 00:27:48 --- Eval epoch-13, step-182 ---
2023-11-27 00:27:48 pr_auc: 0.7614
2023-11-27 00:27:48 roc_auc: 0.7693
2023-11-27 00:27:48 f1: 0.7565
2023-11-27 00:27:48 loss: 0.5469
2023-11-27 00:27:48 
2023-11-27 00:27:48 --- Train epoch-14, step-195 ---
2023-11-27 00:27:48 loss: 0.5037
2023-11-27 00:27:48 --- Eval epoch-14, step-195 ---
2023-11-27 00:27:48 pr_auc: 0.7668
2023-11-27 00:27:48 roc_auc: 0.7685
2023-11-27 00:27:48 f1: 0.7544
2023-11-27 00:27:48 loss: 0.5419
2023-11-27 00:27:48 
2023-11-27 00:27:48 --- Train epoch-15, step-208 ---
2023-11-27 00:27:48 loss: 0.5145
2023-11-27 00:27:48 --- Eval epoch-15, step-208 ---
2023-11-27 00:27:48 pr_auc: 0.7706
2023-11-27 00:27:48 roc_auc: 0.7726
2023-11-27 00:27:48 f1: 0.7565
2023-11-27 00:27:48 loss: 0.5368
2023-11-27 00:27:48 
2023-11-27 00:27:49 --- Train epoch-16, step-221 ---
2023-11-27 00:27:49 loss: 0.4934
2023-11-27 00:27:49 --- Eval epoch-16, step-221 ---
2023-11-27 00:27:49 pr_auc: 0.7715
2023-11-27 00:27:49 roc_auc: 0.7744
2023-11-27 00:27:49 f1: 0.7424
2023-11-27 00:27:49 loss: 0.5342
2023-11-27 00:27:49 New best roc_auc score (0.7744) at epoch-16, step-221
2023-11-27 00:27:49 
2023-11-27 00:27:49 --- Train epoch-17, step-234 ---
2023-11-27 00:27:49 loss: 0.4708
2023-11-27 00:27:49 --- Eval epoch-17, step-234 ---
2023-11-27 00:27:49 pr_auc: 0.7750
2023-11-27 00:27:49 roc_auc: 0.7779
2023-11-27 00:27:49 f1: 0.7745
2023-11-27 00:27:49 loss: 0.5346
2023-11-27 00:27:49 New best roc_auc score (0.7779) at epoch-17, step-234
2023-11-27 00:27:49 
2023-11-27 00:27:49 --- Train epoch-18, step-247 ---
2023-11-27 00:27:49 loss: 0.4519
2023-11-27 00:27:49 --- Eval epoch-18, step-247 ---
2023-11-27 00:27:49 pr_auc: 0.7765
2023-11-27 00:27:49 roc_auc: 0.7803
2023-11-27 00:27:49 f1: 0.7692
2023-11-27 00:27:49 loss: 0.5344
2023-11-27 00:27:49 New best roc_auc score (0.7803) at epoch-18, step-247
2023-11-27 00:27:49 
2023-11-27 00:27:49 --- Train epoch-19, step-260 ---
2023-11-27 00:27:49 loss: 0.4455
2023-11-27 00:27:50 --- Eval epoch-19, step-260 ---
2023-11-27 00:27:50 pr_auc: 0.7766
2023-11-27 00:27:50 roc_auc: 0.7780
2023-11-27 00:27:50 f1: 0.7511
2023-11-27 00:27:50 loss: 0.5303
2023-11-27 00:27:50 Loaded best model
2023-11-27 00:28:27 RETAIN(
  (embeddings): ModuleDict(
    (diagnoses): Embedding(601, 128, padding_idx=0)
  )
  (linear_layers): ModuleDict()
  (retain): ModuleDict(
    (diagnoses): RETAINLayer(
      (dropout_layer): Dropout(p=0.5, inplace=False)
      (alpha_gru): GRU(128, 128, batch_first=True)
      (beta_gru): GRU(128, 128, batch_first=True)
      (alpha_li): Linear(in_features=128, out_features=1, bias=True)
      (beta_li): Linear(in_features=128, out_features=128, bias=True)
    )
  )
  (fc): Linear(in_features=128, out_features=1, bias=True)
)
2023-11-27 00:28:27 Metrics: ['pr_auc', 'roc_auc', 'f1']
2023-11-27 00:28:27 Device: cuda
2023-11-27 00:28:27 
2023-11-27 00:28:27 Training:
2023-11-27 00:28:27 Batch size: 64
2023-11-27 00:28:27 Optimizer: <class 'torch.optim.adam.Adam'>
2023-11-27 00:28:27 Optimizer params: {'lr': 0.001}
2023-11-27 00:28:27 Weight decay: 0.0
2023-11-27 00:28:27 Max grad norm: None
2023-11-27 00:28:27 Val dataloader: <torch.utils.data.dataloader.DataLoader object at 0x7fbe2f844520>
2023-11-27 00:28:27 Monitor: roc_auc
2023-11-27 00:28:27 Monitor criterion: max
2023-11-27 00:28:27 Epochs: 20
2023-11-27 00:28:27 
2023-11-27 00:28:27 --- Train epoch-0, step-13 ---
2023-11-27 00:28:27 loss: 0.6890
2023-11-27 00:28:27 --- Eval epoch-0, step-13 ---
2023-11-27 00:28:27 pr_auc: 0.6724
2023-11-27 00:28:27 roc_auc: 0.6552
2023-11-27 00:28:27 f1: 0.7080
2023-11-27 00:28:27 loss: 0.6754
2023-11-27 00:28:27 New best roc_auc score (0.6552) at epoch-0, step-13
2023-11-27 00:28:27 
2023-11-27 00:28:28 --- Train epoch-1, step-26 ---
2023-11-27 00:28:28 loss: 0.6443
2023-11-27 00:28:28 --- Eval epoch-1, step-26 ---
2023-11-27 00:28:28 pr_auc: 0.7390
2023-11-27 00:28:28 roc_auc: 0.7326
2023-11-27 00:28:28 f1: 0.7063
2023-11-27 00:28:28 loss: 0.6501
2023-11-27 00:28:28 New best roc_auc score (0.7326) at epoch-1, step-26
2023-11-27 00:28:28 
2023-11-27 00:28:28 --- Train epoch-2, step-39 ---
2023-11-27 00:28:28 loss: 0.6090
2023-11-27 00:28:28 --- Eval epoch-2, step-39 ---
2023-11-27 00:28:28 pr_auc: 0.7614
2023-11-27 00:28:28 roc_auc: 0.7647
2023-11-27 00:28:28 f1: 0.7300
2023-11-27 00:28:28 loss: 0.6397
2023-11-27 00:28:28 New best roc_auc score (0.7647) at epoch-2, step-39
2023-11-27 00:28:28 
2023-11-27 00:28:28 --- Train epoch-3, step-52 ---
2023-11-27 00:28:28 loss: 0.5938
2023-11-27 00:28:29 --- Eval epoch-3, step-52 ---
2023-11-27 00:28:29 pr_auc: 0.7655
2023-11-27 00:28:29 roc_auc: 0.7755
2023-11-27 00:28:29 f1: 0.7603
2023-11-27 00:28:29 loss: 0.5997
2023-11-27 00:28:29 New best roc_auc score (0.7755) at epoch-3, step-52
2023-11-27 00:28:29 
2023-11-27 00:28:29 --- Train epoch-4, step-65 ---
2023-11-27 00:28:29 loss: 0.5551
2023-11-27 00:28:29 --- Eval epoch-4, step-65 ---
2023-11-27 00:28:29 pr_auc: 0.7727
2023-11-27 00:28:29 roc_auc: 0.7817
2023-11-27 00:28:29 f1: 0.7932
2023-11-27 00:28:29 loss: 0.5812
2023-11-27 00:28:29 New best roc_auc score (0.7817) at epoch-4, step-65
2023-11-27 00:28:29 
2023-11-27 00:28:29 --- Train epoch-5, step-78 ---
2023-11-27 00:28:29 loss: 0.5247
2023-11-27 00:28:29 --- Eval epoch-5, step-78 ---
2023-11-27 00:28:29 pr_auc: 0.7756
2023-11-27 00:28:29 roc_auc: 0.7847
2023-11-27 00:28:29 f1: 0.7860
2023-11-27 00:28:29 loss: 0.5772
2023-11-27 00:28:29 New best roc_auc score (0.7847) at epoch-5, step-78
2023-11-27 00:28:29 
2023-11-27 00:28:29 --- Train epoch-6, step-91 ---
2023-11-27 00:28:29 loss: 0.4954
2023-11-27 00:28:29 --- Eval epoch-6, step-91 ---
2023-11-27 00:28:29 pr_auc: 0.7808
2023-11-27 00:28:29 roc_auc: 0.7949
2023-11-27 00:28:29 f1: 0.8018
2023-11-27 00:28:29 loss: 0.5632
2023-11-27 00:28:29 New best roc_auc score (0.7949) at epoch-6, step-91
2023-11-27 00:28:29 
2023-11-27 00:28:30 --- Train epoch-7, step-104 ---
2023-11-27 00:28:30 loss: 0.4877
2023-11-27 00:28:30 --- Eval epoch-7, step-104 ---
2023-11-27 00:28:30 pr_auc: 0.7768
2023-11-27 00:28:30 roc_auc: 0.7962
2023-11-27 00:28:30 f1: 0.7822
2023-11-27 00:28:30 loss: 0.5572
2023-11-27 00:28:30 New best roc_auc score (0.7962) at epoch-7, step-104
2023-11-27 00:28:30 
2023-11-27 00:28:30 --- Train epoch-8, step-117 ---
2023-11-27 00:28:30 loss: 0.4586
2023-11-27 00:28:30 --- Eval epoch-8, step-117 ---
2023-11-27 00:28:30 pr_auc: 0.7647
2023-11-27 00:28:30 roc_auc: 0.7842
2023-11-27 00:28:30 f1: 0.7580
2023-11-27 00:28:30 loss: 0.5577
2023-11-27 00:28:30 
2023-11-27 00:28:30 --- Train epoch-9, step-130 ---
2023-11-27 00:28:30 loss: 0.4280
2023-11-27 00:28:30 --- Eval epoch-9, step-130 ---
2023-11-27 00:28:30 pr_auc: 0.7607
2023-11-27 00:28:30 roc_auc: 0.7788
2023-11-27 00:28:30 f1: 0.7580
2023-11-27 00:28:30 loss: 0.5780
2023-11-27 00:28:30 
2023-11-27 00:28:31 --- Train epoch-10, step-143 ---
2023-11-27 00:28:31 loss: 0.3954
2023-11-27 00:28:31 --- Eval epoch-10, step-143 ---
2023-11-27 00:28:31 pr_auc: 0.7648
2023-11-27 00:28:31 roc_auc: 0.7750
2023-11-27 00:28:31 f1: 0.7545
2023-11-27 00:28:31 loss: 0.5786
2023-11-27 00:28:31 
2023-11-27 00:28:31 --- Train epoch-11, step-156 ---
2023-11-27 00:28:31 loss: 0.3829
2023-11-27 00:28:31 --- Eval epoch-11, step-156 ---
2023-11-27 00:28:31 pr_auc: 0.7759
2023-11-27 00:28:31 roc_auc: 0.7856
2023-11-27 00:28:31 f1: 0.7523
2023-11-27 00:28:31 loss: 0.5592
2023-11-27 00:28:31 
2023-11-27 00:28:31 --- Train epoch-12, step-169 ---
2023-11-27 00:28:31 loss: 0.3781
2023-11-27 00:28:31 --- Eval epoch-12, step-169 ---
2023-11-27 00:28:31 pr_auc: 0.7788
2023-11-27 00:28:31 roc_auc: 0.7907
2023-11-27 00:28:31 f1: 0.7489
2023-11-27 00:28:31 loss: 0.5554
2023-11-27 00:28:31 
2023-11-27 00:28:31 --- Train epoch-13, step-182 ---
2023-11-27 00:28:31 loss: 0.3242
2023-11-27 00:28:31 --- Eval epoch-13, step-182 ---
2023-11-27 00:28:31 pr_auc: 0.7844
2023-11-27 00:28:31 roc_auc: 0.7903
2023-11-27 00:28:31 f1: 0.7373
2023-11-27 00:28:31 loss: 0.5529
2023-11-27 00:28:31 
2023-11-27 00:28:32 --- Train epoch-14, step-195 ---
2023-11-27 00:28:32 loss: 0.3310
2023-11-27 00:28:32 --- Eval epoch-14, step-195 ---
2023-11-27 00:28:32 pr_auc: 0.7806
2023-11-27 00:28:32 roc_auc: 0.7952
2023-11-27 00:28:32 f1: 0.7290
2023-11-27 00:28:32 loss: 0.5647
2023-11-27 00:28:32 
2023-11-27 00:28:32 --- Train epoch-15, step-208 ---
2023-11-27 00:28:32 loss: 0.2925
2023-11-27 00:28:32 --- Eval epoch-15, step-208 ---
2023-11-27 00:28:32 pr_auc: 0.7746
2023-11-27 00:28:32 roc_auc: 0.7932
2023-11-27 00:28:32 f1: 0.7489
2023-11-27 00:28:32 loss: 0.5785
2023-11-27 00:28:32 
2023-11-27 00:28:32 --- Train epoch-16, step-221 ---
2023-11-27 00:28:32 loss: 0.2872
2023-11-27 00:28:32 --- Eval epoch-16, step-221 ---
2023-11-27 00:28:32 pr_auc: 0.7843
2023-11-27 00:28:32 roc_auc: 0.7942
2023-11-27 00:28:32 f1: 0.7421
2023-11-27 00:28:32 loss: 0.6026
2023-11-27 00:28:32 
2023-11-27 00:28:32 --- Train epoch-17, step-234 ---
2023-11-27 00:28:32 loss: 0.2841
2023-11-27 00:28:32 --- Eval epoch-17, step-234 ---
2023-11-27 00:28:32 pr_auc: 0.7776
2023-11-27 00:28:32 roc_auc: 0.7883
2023-11-27 00:28:32 f1: 0.7364
2023-11-27 00:28:32 loss: 0.6263
2023-11-27 00:28:32 
2023-11-27 00:28:33 --- Train epoch-18, step-247 ---
2023-11-27 00:28:33 loss: 0.2695
2023-11-27 00:28:33 --- Eval epoch-18, step-247 ---
2023-11-27 00:28:33 pr_auc: 0.7726
2023-11-27 00:28:33 roc_auc: 0.7843
2023-11-27 00:28:33 f1: 0.7453
2023-11-27 00:28:33 loss: 0.6259
2023-11-27 00:28:33 
2023-11-27 00:28:33 --- Train epoch-19, step-260 ---
2023-11-27 00:28:33 loss: 0.2427
2023-11-27 00:28:33 --- Eval epoch-19, step-260 ---
2023-11-27 00:28:33 pr_auc: 0.7767
2023-11-27 00:28:33 roc_auc: 0.7861
2023-11-27 00:28:33 f1: 0.7407
2023-11-27 00:28:33 loss: 0.6537
2023-11-27 00:28:33 Loaded best model
